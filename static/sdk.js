var $jscomp={scope:{},findInternal:function(l,b,a){l instanceof String&&(l=String(l));for(var f=l.length,h=0;h<f;h++){var m=l[h];if(b.call(a,m,h,l))return{i:h,v:m}}return{i:-1,v:void 0}}};$jscomp.defineProperty="function"==typeof Object.defineProperties?Object.defineProperty:function(l,b,a){if(a.get||a.set)throw new TypeError("ES3 does not support getters and setters.");l!=Array.prototype&&l!=Object.prototype&&(l[b]=a.value)};
$jscomp.getGlobal=function(l){return"undefined"!=typeof window&&window===l?l:"undefined"!=typeof global&&null!=global?global:l};$jscomp.global=$jscomp.getGlobal(this);$jscomp.polyfill=function(l,b,a,f){if(b){a=$jscomp.global;l=l.split(".");for(f=0;f<l.length-1;f++){var h=l[f];h in a||(a[h]={});a=a[h]}l=l[l.length-1];f=a[l];b=b(f);b!=f&&null!=b&&$jscomp.defineProperty(a,l,{configurable:!0,writable:!0,value:b})}};
$jscomp.polyfill("Array.prototype.find",function(l){return l?l:function(b,a){return $jscomp.findInternal(this,b,a).v}},"es6-impl","es3");
(function(l){function b(f){if(a[f])return a[f].exports;var h=a[f]={exports:{},id:f,loaded:!1};l[f].call(h.exports,h,h.exports,b);h.loaded=!0;return h.exports}var a={};b.m=l;b.c=a;b.p="";return b(0)})([function(l,b,a){a(84).set("web");l=a(85);window.WebIMSDK=l},function(l,b){l.exports=window.jQuery},,,,function(l,b){b=function(){this._events={}};b.prototype={addEventListener:function(a,b){var f=this._events[a];if(null!=f){for(var m=!1,g=0;g<f.length;g++)if(f[g]==b){m=!0;break}0==m&&f.push(b)}else f=
    [],f.push(b);this._events[a]=f},removeEventListener:function(a,b){a=this._events[a];if(null!=a)for(var f=0;f<a.length;f++)if(a[f]==b){a[f]=null;break}},triggerEvent:function(a){var b=this._events[a];if(null!=b)for(var h=0;h<b.length;h++){var m=b[h];null!=m&&m.apply(null,Array.prototype.slice.call(arguments,1))}}};l.exports=b},,,,,,,,,function(l,b){l.exports=function(a){var b={},h;if(!(a instanceof Object)||Array.isArray(a))throw Error("keyMirror(...): Argument must be an object.");for(h in a)a.hasOwnProperty(h)&&
(b[h]=h);return b}},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(l,b,a){var f=a(1);b=function(a){this._options=this._timer=null;(function(b){var g={onElapsed:function(a){a()},duration:2E3};f.extend(g,a);b._options=g})(this)};b.prototype.setDuration=function(a){this._options.duration=a};b.prototype.start=function(){if(!this._timer){var a=this;(function g(){a._options.onElapsed(function(){a._timer=setTimeout(function(){g()},a._options.duration)})})()}};b.prototype.stop=function(){clearTimeout(this._timer);
    this._timer=null};l.exports=b},,,,,,,,,,,,,,,,,,,,,,,,,,function(l,b){l.exports=function(a){try{var b=document.createElement("INPUT");b.type="hidden";b.style.display="none";b.addBehavior("#default#userData");document.body.appendChild(b);var h=new Date;h.setDate(h.getDate()+365);b.expires=h.toUTCString();return{load:function(){try{b.load(a)}catch(m){void 0}},save:function(){try{b.save(a)}catch(m){void 0}},getAttribute:function(a){try{return b.getAttribute(a)}catch(g){void 0}},setAttribute:function(a,
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          g){try{b.setAttribute(a,g)}catch(r){void 0}},removeAttribute:function(a){try{b.removeAttribute(a)}catch(g){void 0}},clear:function(){try{var a=new Date;a.setMinutes(a.getMinutes()-1);b.expires=a.toUTCString();this.save()}catch(g){void 0}}}}catch(m){return void 0,null}}},function(l,b){var a="";l.exports={get:function(){return a},set:function(b){a=b}}},function(l,b,a){a(86);var f=a(1),h=a(5),m=a(95),g=a(57),r=a(97),u=a(98),n=a(105),z=a(126),t=a(127),c=new (a(129))({getLoadedUsers:function(c){var d=
    t.getAllSessions();c(D(d))}}),q=a(131);b=a(132);var e=a(125),x=a(84).get(),d=a(106),k=a(107),y=a(130),D=function(c){var d=[];f.each(c,function(c,e){d.push(e.user)});return d},C=new b({ack:function(c,d,e){if("message"==c.valueType||"commandmsg"==c.valueType){c=J(c.value);for(var a=[],k=0;k<c.length;k++){for(var b={},b=[],q=c[k].msg_list,x=0;x<q.length;x++)b.push(q[x].msg_id);b={sender_id:c[k].sender_id,sender_source:c[k].sender_source,to_id:q[0].to_id,to_source:q[0].to_source,msg_ids:b};a.push(b)}n.ackMsgBatch(a,
    function(){d()},function(){e()})}else void 0,e()}}),J=function(c){if("[object Array]"!=Object.prototype.toString.call(c))return void 0,[];for(var d={},e=0,a=c.length;e<a;e++){var k=c[e];"string"==typeof k.content&&(k.content=JSON.parse(k.content));var b=k.sender_id+"@"+k.sender_source;d[b]?d[b].push(k):d[b]=[k]}var q=[];f.each(d,function(c,d){c=c.split("@");q.push({sender_id:c[0],sender_source:c[1],msg_list:d.sort(function(c,d){return c.msg_id<d.msg_id?1:c.msg_id>d.msg_id?-1:0})})});return q},F=function(c){for(var d=
    [],e=0;e<c.length;e++)-1<["text","image","audio","location"].indexOf(c[e].show_type.toString())&&(c[e].refer&&c[e].refer.invitation||d.push(c[e]));return d},I=function(c,d,e){for(var a=null,k=0;k<e.length;k++)if(-1<["text","image","audio","location"].indexOf(e[k].show_type.toString())&&e[k].refer&&-1!==e[k].refer.indexOf("invitation")&&(a=e[k].refer,"string"===typeof a&&(a=JSON.parse(a)),a.invitation)){if(e[k].sender_id!==c||e[k].sender_source!==d)a.invitation.role=a.invitation.role&&"2"===a.invitation.role.toString()?
    "1":a.invitation.role&&"1"===a.invitation.role.toString()?"2":"",a.invitation.refer_time=e[k].send_time;break}return a},N=function(c,d){var e=this,a=function(){var c=[],d=0;return function(k,b){d++;if(1<d)return b(null);e.getMsgRecords(k,function(d){if(0===d.length)return b(null);var e=I(k.user_id,k.user_source,d);e&&b({refer:e,user_id:k.user_id,user_source:k.user_source});Array.prototype.push.apply(c,F(d));!e&&5>c.length?(k.msg_id=d[d.length-1].msg_id,a(k,b)):!e&&5<=c.length&&b(null)},function(){b(null)})}}();
    a(c,d)},T=function(c,d,e){var k=I(c,d,e);k?n.setRefer(c,d,k):this.getRefer(c,d)||N.call(this,{user_id:c,user_source:d,msg_id:e[e.length-1].msg_id,count:20,option:-1},function(c){c&&c.refer&&n.setRefer(c.user_id,c.user_source,c.refer)})},U=function(){var c=0;return function R(d){var e=(new Date).getTime(),k=e-c;if(3E3<k)c=e,this._options.getNewToken(function(c){d(c)});else{var a=R.bind(this);setTimeout(function(){a(d)},k-3E3)}}}();b=function(d){h.call(this);this._loginstatus=!1;this._loginstatusTimer=
    null;this._options;(function(a){a.init(d);C.addEventListener("logout",function(c){void 0;a.stop(c)});C.addEventListener("connectchange",function(c,d){a.triggerEvent("connectchange",c,d)});C.addEventListener("msgReceived",function(c){var d=[];f.each(c,function(c,e){e.sender_id==e.to_id&&e.sender_source==e.to_source||!n.isNeedShow(e)||("image"===e.show_type&&e.content&&(e.content.url=y.convert(e.content.url+"")),"audio"===e.show_type&&(e.content.url=k["audio-converter"](e.content.url)),d.push(e))});
    if(0!==d.length){var b=[],q={};f.each(d,function(c,d){if(d.options&&d.options.client_only&&"1"===d.options.client_only+""){if(c=e.get(),d.sender_id+""!==c.user_id+""||d.sender_source+""!==c.user_source)c=d.sender_id+"@"+d.sender_source,q[c]||(q[c]=[]),0<q[c].length&&q[c][0].msg_id>d.msg_id?q[c].unshift(d):q[c].push(d)}else b.push(d)});n.saveMsgs(b);a.triggerEvent("falseNews",q);var x={},g={},u=e.get();f.each(d,function(c,d){if(u.user_id==d.sender_id&&u.user_source==d.sender_source){if(c=!0,d.options&&
        d.options.sender_hide&&"1"===d.options.sender_hide.toString())return!0}else c=!1;var e;e=c?d.to_id+"@"+d.to_source:d.sender_id+"@"+d.sender_source;x[e]?x[e].msg_id<d.msg_id&&(x[e]=d):x[e]=d;if("tip"===d.show_type.toString())return!0;c||(g[e]=g[e]?g[e]+1:1)});var D=[];f.each(g,function(c,d){D.push({contact:c,num:d})});n.saveUnreadNum(D);var r=[];f.each(x,function(c,d){var e=c.split("@");c=e[0];var e=e[1],a="string"===typeof d.content?JSON.parse(d.content):d.content;r.push({user:{user_id:c,user_source:e},
        msg:{content:a,send_time:d.send_time,msg_id:d.msg_id,msg_type:d.msg_type,client_only:d.options?d.options.client_only:"0"}})});t.insert(r);c=J(d);a.triggerEvent("msgReceived",c);for(var h=0,m=c.length;h<m;h++){var C=c[h].sender_id,z=c[h].sender_source,P=I(C,z,c[h].msg_list);P&&n.setRefer(C,z,P)}}});c.addEventListener("onlineChanged",function(c){a.triggerEvent("contactOnlineStatusChanged",c)});n.addEventListener("syncAppData",function(c){a.triggerEvent("syncAppData",c)});n.addEventListener("unreadChanged",
    function(c){a.triggerEvent("unreadChanged",c)});n.addEventListener("referChanged",function(c){a.triggerEvent("referChanged",c)});t.addEventListener("changed",function(c){a.triggerEvent("sessionChanged",c)});t.addEventListener("newSessionLoaded",function(d,e){c.updateOnlineStatus(d,D(e))})})(this)};b.prototype=Object.create(h.prototype);b.prototype.init=function(c){var b=this,q={comet:null,api:null,uploadimg:null,user_id:null,source:null,im_token:null,client_version:null,client_type:null,os_type:m.name,
    os_version:m.version,appid:"",sdk_version:4630,stat_dev_info:!1,getNewToken:function(c){c("token")}};f.extend(q,c);k.appid=q.appid;this._options=q;c={user_id:q.user_id,source:q.source,im_token:q.im_token,client_version:q.client_version,client_type:q.client_type,os_type:q.os_type,os_version:q.os_version,appid:q.appid,sdk_version:q.sdk_version};c.im_token||(c.im_token="whatever",c.device_id=c.user_id);if(q.stat_dev_info){var x=a(133);f.extend(c,{device_info:x,xxzl_smartid:"1"})}r.init(q.api,c,function(c){switch(c.error_code){case 40002:case 40012:case 40013:void 0,
    b.stop("ajax error code:"+c.error_code),U.call(b,function(c){b._options.im_token=c;b.init(b._options);b.start()})}});C.init(q.comet,c);z.init({api:q.uploadimg});e.set(q.user_id,q.source);d.init()};b.prototype.start=function(){var d=this,a=e.get();u("init",null,null,function(){c.getLoginInfo(function(c){var d=!1;(c=c?c.user:null)&&c.user_id==a.user_id&&c.user_source==a.user_source||(d=!0);d?k(function(){q(function(){b(function(){y()})})}):b(function(){y()})},function(){void 0})},function(c){d.triggerEvent("imTokenExpired",
    c)});var k=function(d){var e=3,a=function(){e--;0<e||d()};n.clearAll(function(){a()},function(){a()});c.clearAll(function(){a()},function(){a()});t.clearAll(function(){a()},function(){a()})},q=function(d){c.setLoginInfo(!0,function(){d()},function(){d()})},b=function(e){c.getImToken(function(a){a!=d._options.im_token?(c.setImToken(d._options.im_token),d.emptyMsg(function(){e&&e()},function(){e&&e()})):e&&e()},function(){e&&e()})},y=function(){c.setLoginInfo(!0,function(){d.triggerEvent("login");d._loginstatus=
    !0;"web"!=x||d._loginstatusTimer||(d._loginstatusTimer=new g({onElapsed:function(a){c.getLoginInfo(function(k){var q=e.get();if(!k)return a();var b=k.user;(q=q.user_id!=b.user_id||q.user_source!=b.user_source)&&d.triggerEvent("userChanged");if(!k.status)return void 0,d.stop("\u4ece\u6570\u636e\u5e93\u8bfb\u53d6\u51fa\u767b\u5f55\u72b6\u6001\u4e3afalse"),a();k=!1;q?(void 0,k=!0):d._loginstatus||(k=!0,void 0);if(k)d.stop("\u5207\u6362\u8d26\u53f7\u6216\u8005\u540c\u6b65\u767b\u5f55\u72b6\u6001\uff01"),
    d._options.user_id=b.user_id,d._options.user_source=b.user_source,c.getImToken(function(c){if(d._options.im_token==c)return a();d._options.im_token=c;d.init(d._options);d.start();a()},function(){a()});else return a()},function(){a()})},duration:1E3}),d._loginstatusTimer.start());c.getCometStatus(function(d){d&&1==d.isForceOff?c.setCometStatus(!1,function(){C.start()}):C.start()});t.start();c.start();n.start()},function(){y()})}};b.prototype.stop=function(d){void 0;C.stop();t.stop();c.stop();n.stop();
    this._loginstatus=!1;this.triggerEvent("logout",d)};b.prototype.addSession=function(d){this.getContact(d.user.user_id,d.user.user_source,function(d){c.addUser(d);t.insert({user:{user_id:d.user_id,user_source:d.user_source},msg:null})})};b.prototype.getContact=function(){if(3===arguments.length){var d=arguments[2];c.getUserinfo({target_user_id:arguments[0],target_user_source:arguments[1]},function(c){d(c)},function(c){d(null)})}else if(2===arguments.length){var e=arguments[0],d=arguments[1];c.getUserinfos(e,
    function(c){d(c)},function(){d({})})}};b.prototype.sendMsg=function(c){var d={msg:null,onUploadImgBegin:function(){},onUploadImgSuccess:function(){},onUploadImgFail:function(){},onSendMsgBegin:function(){},onSendMsgSuccess:function(){},onSendMsgFail:function(){}};f.extend(d,c);var a=function(c){var a=e.get(),k={sender_id:a.user_id,sender_source:a.user_source,to_id:c.to_id,to_source:c.to_source,msg_type:c.msg_type,show_type:c.show_type,content:f.extend(!0,{},c.content),options:c.options,show_in_app:c.show_in_app,
    refer:f.extend(!0,{},c.refer)};d.onSendMsgBegin();n.send(k,function(c){d.onSendMsgSuccess(c);t.insert({user:{user_id:k.to_id,user_source:k.to_source},msg:{content:k.content,send_time:c.send_time,msg_id:c.msg_id,msg_type:k.msg_type}})},function(c){d.onSendMsgFail(c)})},k=c.msg;"image"===k.content.type&&-1===k.content.url.indexOf("http")?(d.onUploadImgBegin(),z.upload(k.content.url,function(c){k.content.url=c;d.onUploadImgSuccess(k);a(k)},function(c){d.onUploadImgFail(c)})):a(k)};b.prototype.getOnlineStatus=
    function(){if(3===arguments.length){var d=arguments[2];c.getUserOnlineInfo(arguments[0],arguments[1],function(c){d(c)},function(c){d(null)})}else if(2===arguments.length){var e=arguments[0],d=arguments[1];c.getUsersOnlineInfo(e,function(c){d(c)},function(){d({})})}};b.prototype.startOnlineTimer=function(){c.startOnlineTimer()};b.prototype.stopOnlineTimer=function(){c.stopOnlineTimer()};b.prototype.read=function(c,d){var e=t.getSession(c,d),e=e?e.msg:null;n.setUnreadToZero(c,d,e?e.msg_id:null)};b.prototype.getMsgRecords=
    function(c,d,e){var a=this,q=this.me();n.getMsgRecords(c,function(e){if(0===e.length)return d(e);if("-1"===c.option.toString()&&"10"===c.count.toString())if(c.msg_id){var b=I(c.user_id,c.user_source,e);b&&n.setRefer(c.user_id,c.user_source,b)}else T.call(a,c.user_id,c.user_source,e);a.getContact([{user_id:c.user_id,user_source:c.user_source},{user_id:q.user_id,user_source:q.user_source}],function(c){f.each(e,function(d,e){e.sender_info=c[e.sender_id+"@"+e.sender_source];e.to_info=c[e.to_id+"@"+e.to_source];
        "image"===e.show_type&&e.content&&(e.content.url=y.convert(e.content.url+""));"audio"===e.show_type&&(e.content.url=k["audio-converter"](e.content.url))});d(e)})},e)};b.prototype.getSessions=function(c,d,e){t.getSessions(function(c,e){d(c,e)})};b.prototype.getCaptcha=function(c,d,e){q.getCaptcha(c,d,e)};b.prototype.validateCaptcha=function(c,d,e){q.validateCaptcha(c,d,e)};b.prototype.getAllUnreadAmount=function(){return n.getAllUnreadAmount()};b.prototype.getAllSessions=function(){return t.getAllSessions()};
    b.prototype.isMain=function(){return C._isconnected};b.prototype.me=function(){return e.get()};b.prototype.connect=function(){C.connect()};b.prototype.isLogined=function(){return this._loginstatus};b.prototype.emptyMsg=function(c,d){n.clearAll(c,d)};b.prototype.ackMsgRead=function(c,d,e){n.ackRead(c,d,e)};b.prototype.getRefer=function(c,d){return n.getRefer(c,d)};b.prototype.setRefer=function(c,d,e){return n.setRefer(c,d,e)};l.exports=b},function(l,b,a){a(87);a(88);a(89);a(90);a(91);a(92);a(93);a(94)},
    function(l,b){Array.isArray||(Array.isArray=function(a){return"[object Array]"===Object.prototype.toString.call(a)})},function(l,b){Array.prototype.filter||(Array.prototype.filter=function(a){if(void 0===this||null===this)throw new TypeError;var b=Object(this),h=b.length>>>0;if("function"!==typeof a)throw new TypeError;for(var m=[],g=2<=arguments.length?arguments[1]:void 0,r=0;r<h;r++)if(r in b){var u=b[r];a.call(g,u,r,b)&&m.push(u)}return m})},function(l,b){Array.prototype.indexOf||(Array.prototype.indexOf=
        function(a,b){if(null==this)throw new TypeError('"this" is null or not defined');var f=Object(this),m=f.length>>>0;if(0===m)return-1;b=+b||0;Infinity===Math.abs(b)&&(b=0);if(b>=m)return-1;for(b=Math.max(0<=b?b:m-Math.abs(b),0);b<m;){if(b in f&&f[b]===a)return b;b++}return-1})},function(l,b){(function(a){a.console||(a.console={});a=a.console;for(var b,h=function(){},m=["memory"],g="assert clear count debug dir dirxml error exception group groupCollapsed groupEnd info log markTimeline profile profiles profileEnd show table time timeEnd timeline timelineEnd timeStamp trace warn".split(" ");b=
        m.pop();)a[b]||(a[b]={});for(;b=g.pop();)"function"!==typeof a[b]&&(a[b]=h)})("undefined"===typeof window?this:window)},function(l,b){Function.prototype.bind||(Function.prototype.bind=function(a){if("function"!==typeof this)throw new TypeError("Function.prototype.bind - what is trying to be bound is not callable");var b=Array.prototype.slice.call(arguments,1),h=this,m=function(){},g=function(){return h.apply(this instanceof m?this:a,b.concat(Array.prototype.slice.call(arguments)))};this.prototype&&
    (m.prototype=this.prototype);g.prototype=new m;return g})},function(l,b){window.indexedDB=window.indexedDB||window.mozIndexedDB||window.webkitIndexedDB||window.msIndexedDB;window.IDBTransaction=window.IDBTransaction||window.webkitIDBTransaction||window.msIDBTransaction;window.IDBKeyRange=window.IDBKeyRange||window.webkitIDBKeyRange||window.msIDBKeyRange},function(l,b){window.JSON||(window.JSON={parse:function(a){return eval("("+a+")")},stringify:function(){var a=Object.prototype.toString,b=Array.isArray||
        function(b){return"[object Array]"===a.call(b)},h={'"':'\\"',"\\":"\\\\","\b":"\\b","\f":"\\f","\n":"\\n","\r":"\\r","\t":"\\t"},m=function(a){return h[a]||"\\u"+(a.charCodeAt(0)+65536).toString(16).substr(1)},g=/[\\"\u0000-\u001F\u2028\u2029]/g;return function u(n){if(null==n)return"null";if("number"===typeof n)return isFinite(n)?n.toString():"null";if("boolean"===typeof n)return n.toString();if("object"===typeof n){if("function"===typeof n.toJSON)return u(n.toJSON());if(b(n)){for(var f="[",t=0;t<
    n.length;t++)f+=(t?", ":"")+u(n[t]);return f+"]"}if("[object Object]"===a.call(n)){f=[];for(t in n)n.hasOwnProperty(t)&&f.push(u(t)+": "+u(n[t]));return"{"+f.join(", ")+"}"}}return'"'+n.toString().replace(g,m)+'"'}}()})},function(l,b){"function"!=typeof Object.create&&(Object.create=function(a){var b=function(){};return function(f,m){if(f!==Object(f)&&null!==f)throw TypeError("Argument must be an object, or null");b.prototype=f||{};var g=new b;b.prototype=null;m!==a&&Object.defineProperties(g,m);
        null===f&&(g.__proto__=null);return g}}())},function(l,b,a){var f;(function(h,m){!(f=function(){function a(c){c=String(c);return c.charAt(0).toUpperCase()+c.slice(1)}function f(c,d){var e=-1,a=c?c.length:0;if("number"==typeof a&&-1<a&&a<=D)for(;++e<a;)d(c[e],e,c);else n(c,d)}function u(c){c=String(c).replace(/^ +| +$/g,"");return/^(?:webOS|i(?:OS|P))/.test(c)?c:a(c)}function n(c,d){for(var e in c)l.call(c,e)&&d(c[e],e,c)}function z(c){return null==c?a(c):I.call(c).slice(8,-1)}function t(c,d){var e=
        null!=c?typeof c[d]:"number";return!/^(?:boolean|number|string|undefined)$/.test(e)&&("object"==e?!!c[d]:!0)}function c(c){return String(c).replace(/([ -])(?!$)/g,"$1?")}function q(c,d){var e=null;f(c,function(a,b){e=d(e,a,b,c)});return e}function e(a){function b(d){return q(d,function(d,e){var b=e.pattern||c(e);!d&&(d=RegExp("\\b"+b+" *\\d+[.\\w_]*","i").exec(a)||RegExp("\\b"+b+"(?:; *(?:[a-z]+[_-])?[a-z]+\\d+|[^ ();-]*)","i").exec(a))&&((d=String(e.label&&!RegExp(b,"i").test(e.label)?e.label:d).split("/"))[1]&&
    !/[\d.]+/.test(d[0])&&(d[0]+=" "+d[1]),e=e.label||e,d=u(d[0].replace(RegExp(b,"i"),e).replace(RegExp("; *(?:"+e+"[_-])?","i")," ").replace(RegExp("("+e+")[-_.]?(\\w)","i"),"$1 $2")));return d})}function x(c){return q(c,function(c,d){return c||(RegExp(d+"(?:-[\\d.]+/|(?: for [\\w-]+)?[ /-])([\\d.]+[^ ();/_-]*)","i").exec(a)||0)[1]||null})}var y=d,g=a&&"object"==typeof a&&"String"!=z(a);g&&(y=a,a=null);var D=y.navigator||{},f=D.userAgent||"";a||(a=f);var r=g||J==k,h=g?!!D.likeChrome:/\bChrome\b/.test(a)&&
        !/internal|\n/i.test(I.toString()),m=g?"Object":"ScriptBridgingProxyObject",l=g?"Object":"Environment",F=g&&y.java?"JavaPackage":z(y.java),N=g?"Object":"RuntimeObject",l=(F=/\bJava/.test(F)&&y.java)&&z(y.environment)==l,S=F?"a":"\u03b1",V=F?"b":"\u03b2",Q=y.document||{},H=y.operamini||y.opera,M=C.test(M=g&&H?H["[[Class]]"]:z(H))?M:H=null,p,K=a,g=[],L=null,G=a==f,f=G&&H&&"function"==typeof H.version&&H.version(),O,A=function(d){return q(d,function(d,e){return d||RegExp("\\b"+(e.pattern||c(e))+"\\b",
            "i").exec(a)&&(e.label||e)})}([{label:"EdgeHTML",pattern:"Edge"},"Trident",{label:"WebKit",pattern:"AppleWebKit"},"iCab","Presto","NetFront","Tasman","KHTML","Gecko"]),v=function(d){return q(d,function(d,e){return d||RegExp("\\b"+(e.pattern||c(e))+"\\b","i").exec(a)&&(e.label||e)})}(["Adobe AIR","Arora","Avant Browser","Breach","Camino","Epiphany","Fennec","Flock","Galeon","GreenBrowser","iCab","Iceweasel","K-Meleon","Konqueror","Lunascape","Maxthon",{label:"Microsoft Edge",pattern:"Edge"},"Midori",
        "Nook Browser","PaleMoon","PhantomJS","Raven","Rekonq","RockMelt","SeaMonkey",{label:"Silk",pattern:"(?:Cloud9|Silk-Accelerated)"},"Sleipnir","SlimBrowser",{label:"SRWare Iron",pattern:"Iron"},"Sunrise","Swiftfox","WebPositive","Opera Mini",{label:"Opera Mini",pattern:"OPiOS"},"Opera",{label:"Opera",pattern:"OPR"},"Chrome",{label:"Chrome Mobile",pattern:"(?:CriOS|CrMo)"},{label:"Firefox",pattern:"(?:Firefox|Minefield)"},{label:"Firefox Mobile",pattern:"FxiOS"},{label:"IE",pattern:"IEMobile"},{label:"IE",
            pattern:"MSIE"},"Safari"]),B=b([{label:"BlackBerry",pattern:"BB10"},"BlackBerry",{label:"Galaxy S",pattern:"GT-I9000"},{label:"Galaxy S2",pattern:"GT-I9100"},{label:"Galaxy S3",pattern:"GT-I9300"},{label:"Galaxy S4",pattern:"GT-I9500"},"Google TV","Lumia","iPad","iPod","iPhone","Kindle",{label:"Kindle Fire",pattern:"(?:Cloud9|Silk-Accelerated)"},"Nexus","Nook","PlayBook","PlayStation 3","PlayStation 4","PlayStation Vita","TouchPad","Transformer",{label:"Wii U",pattern:"WiiU"},"Wii","Xbox One",{label:"Xbox 360",
        pattern:"Xbox"},"Xoom"]),E=function(d){return q(d,function(d,e,b){return d||(e[B]||e[/^[a-z]+(?: +[a-z]+\b)*/i.exec(B)]||RegExp("\\b"+c(b)+"(?:\\b|\\w*\\d)","i").exec(a))&&b})}({Apple:{iPad:1,iPhone:1,iPod:1},Amazon:{Kindle:1,"Kindle Fire":1},Asus:{Transformer:1},"Barnes \x26 Noble":{Nook:1},BlackBerry:{PlayBook:1},Google:{"Google TV":1,Nexus:1},HP:{TouchPad:1},HTC:{},LG:{},Microsoft:{Xbox:1,"Xbox One":1},Motorola:{Xoom:1},Nintendo:{"Wii U":1,Wii:1},Nokia:{Lumia:1},Samsung:{"Galaxy S":1,"Galaxy S2":1,
        "Galaxy S3":1,"Galaxy S4":1},Sony:{"PlayStation 4":1,"PlayStation 3":1,"PlayStation Vita":1}}),w=function(d){return q(d,function(d,e){var b=e.pattern||c(e);if(!d&&(d=RegExp("\\b"+b+"(?:/[\\d.]+|[ \\w.]*)","i").exec(a))){e=e.label||e;var k={"10.0":"10","6.4":"10 Technical Preview","6.3":"8.1","6.2":"8","6.1":"7 / Server 2008 R2","6.0":"Vista / Server 2008","5.2":"XP 64-bit / Server 2003","5.1":"XP","5.01":"2000 SP1","5.0":"2000","4.0":"NT","4.90":"ME"};b&&e&&/^Win/i.test(d)&&!/^Windows Phone /i.test(d)&&
    (k=k[/[\d.]+$/.exec(d)])&&(d="Windows "+k);d=String(d);b&&e&&(d=d.replace(RegExp(b,"i"),e));d=u(d.replace(/ ce$/i," CE").replace(/\bhpw/i,"web").replace(/\bMacintosh\b/,"Mac OS").replace(/_PowerPC\b/i," OS").replace(/\b(OS X) [^ \d]+/i,"$1").replace(/\bMac (OS X)\b/,"$1").replace(/\/(\d)/," $1").replace(/_/g,".").replace(/(?: BePC|[ .]*fc[ \d.]+)$/i,"").replace(/\bx86\.64\b/gi,"x86_64").replace(/\b(Windows Phone) OS\b/,"$1").replace(/\b(Chrome OS \w+) [\d.]+\b/,"$1").split(" on ")[0])}return d})}(["Windows Phone ",
        "Android","CentOS",{label:"Chrome OS",pattern:"CrOS"},"Debian","Fedora","FreeBSD","Gentoo","Haiku","Kubuntu","Linux Mint","OpenBSD","Red Hat","SuSE","Ubuntu","Xubuntu","Cygwin","Symbian OS","hpwOS","webOS ","webOS","Tablet OS","Linux","Mac OS X","Macintosh","Mac","Windows 98;","Windows "]);A&&(A=[A]);E&&!B&&(B=b([E]));if(p=/\bGoogle TV\b/.exec(B))B=p[0];/\bSimulator\b/i.test(a)&&(B=(B?B+" ":"")+"Simulator");"Opera Mini"==v&&/\bOPiOS\b/.test(a)&&g.push("running in Turbo/Uncompressed mode");if(/^iP/.test(B))v||
    (v="Safari"),w="iOS"+((p=/ OS ([\d_]+)/i.exec(a))?" "+p[1].replace(/_/g,"."):"");else if("Konqueror"==v&&!/buntu/i.test(w))w="Kubuntu";else if(E&&"Google"!=E&&(/Chrome/.test(v)&&!/\bMobile Safari\b/i.test(a)||/\bVita\b/.test(B)))v="Android Browser",w=/\bAndroid\b/.test(w)?w:"Android";else if("Silk"==v)/\bMobi/i.test(a)||(w="Android",g.unshift("desktop mode")),/Accelerated *= *true/i.test(a)&&g.unshift("accelerated");else if("PaleMoon"==v&&(p=/\bFirefox\/([\d.]+)\b/.exec(a)))g.push("identifying as Firefox "+
        p[1]);else if("Firefox"==v&&(p=/\b(Mobile|Tablet|TV)\b/i.exec(a)))w||(w="Firefox OS"),B||(B=p[1]);else if(!v||(p=!/\bMinefield\b/i.test(a)&&/\b(?:Firefox|Safari)\b/.exec(v)))v&&!B&&/[\/,]|^[^(]+?\)/.test(a.slice(a.indexOf(p+"/")+8))&&(v=null),(p=B||E||w)&&(B||E||/\b(?:Android|Symbian OS|Tablet OS|webOS)\b/.test(w))&&(v=/[a-z]+(?: Hat)?/i.exec(/\bAndroid\b/.test(w)?w:p)+" Browser");f||(f=x(["(?:Cloud9|CriOS|CrMo|Edge|FxiOS|IEMobile|Iron|Opera ?Mini|OPiOS|OPR|Raven|Silk(?!/[\\d.]+$))","Version",c(v),
        "(?:Firefox|Minefield|NetFront)"]));if(p="iCab"==A&&3<parseFloat(f)&&"WebKit"||/\bOpera\b/.test(v)&&(/\bOPR\b/.test(a)?"Blink":"Presto")||/\b(?:Midori|Nook|Safari)\b/i.test(a)&&!/^(?:Trident|EdgeHTML)$/.test(A)&&"WebKit"||!A&&/\bMSIE\b/i.test(a)&&("Mac OS"==w?"Tasman":"Trident")||"WebKit"==A&&/\bPlayStation\b(?! Vita\b)/i.test(v)&&"NetFront")A=[p];"IE"==v&&(p=(/; *(?:XBLWP|ZuneWP)(\d+)/i.exec(a)||0)[1])?(v+=" Mobile",w="Windows Phone "+(/\+$/.test(p)?p:p+".x"),g.unshift("desktop mode")):/\bWPDesktop\b/i.test(a)?
        (v="IE Mobile",w="Windows Phone 8.x",g.unshift("desktop mode"),f||(f=(/\brv:([\d.]+)/.exec(a)||0)[1])):"IE"!=v&&"Trident"==A&&(p=/\brv:([\d.]+)/.exec(a))&&(v&&g.push("identifying as "+v+(f?" "+f:"")),v="IE",f=p[1]);if(G){if(t(y,"global"))if(F&&(p=F.lang.System,K=p.getProperty("os.arch"),w=w||p.getProperty("os.name")+" "+p.getProperty("os.version")),r&&t(y,"system")&&(p=[y.system])[0]){w||(w=p[0].os||null);try{p[1]=y.require("ringo/engine").version,f=p[1].join("."),v="RingoJS"}catch(W){p[0].global.system==
    y.system&&(v="Narwhal")}}else"object"==typeof y.process&&(p=y.process)?(v="Node.js",K=p.arch,w=p.platform,f=/[\d.]+/.exec(p.version)[0]):l&&(v="Rhino");else z(p=y.runtime)==m?(v="Adobe AIR",w=p.flash.system.Capabilities.os):z(p=y.phantom)==N?(v="PhantomJS",f=(p=p.version||null)&&p.major+"."+p.minor+"."+p.patch):"number"==typeof Q.documentMode&&(p=/\bTrident\/(\d+)/i.exec(a))&&(f=[f,Q.documentMode],(p=+p[1]+4)!=f[1]&&(g.push("IE "+f[1]+" mode"),A&&(A[1]=""),f[1]=p),f="IE"==v?String(f[1].toFixed(1)):
            f[0]);w=w&&u(w)}f&&(p=/(?:[ab]|dp|pre|[ab]\d+pre)(?:\d+\+?)?$/i.exec(f)||/(?:alpha|beta)(?: ?\d)?/i.exec(a+";"+(G&&D.appMinorVersion))||/\bMinefield\b/i.test(a)&&"a")&&(L=/b/i.test(p)?"beta":"alpha",f=f.replace(RegExp(p+"\\+?$"),"")+("beta"==L?V:S)+(/\d+\+?/.exec(p)||""));"Fennec"==v||"Firefox"==v&&/\b(?:Android|Firefox OS)\b/.test(w)?v="Firefox Mobile":"Maxthon"==v&&f?f=f.replace(/\.[\d.]+/,".x"):/\bXbox\b/i.test(B)?(w=null,"Xbox 360"==B&&/\bIEMobile\b/.test(a)&&g.unshift("mobile mode")):!/^(?:Chrome|IE|Opera)$/.test(v)&&
    (!v||B||/Browser|Mobi/.test(v))||"Windows CE"!=w&&!/Mobi/i.test(a)?"IE"==v&&G&&null===y.external?g.unshift("platform preview"):(/\bBlackBerry\b/.test(B)||/\bBB10\b/.test(a))&&(p=(RegExp(B.replace(/ +/g," *")+"/([.\\d]+)","i").exec(a)||0)[1]||f)?(p=[p,/BB10/.test(a)],w=(p[1]?(B=null,E="BlackBerry"):"Device Software")+" "+p[0],f=null):this!=n&&"Wii"!=B&&(G&&H||/Opera/.test(v)&&/\b(?:MSIE|Firefox)\b/i.test(a)||"Firefox"==v&&/\bOS X (?:\d+\.){2,}/.test(w)||"IE"==v&&(w&&!/^Win/.test(w)&&5.5<f||/\bWindows XP\b/.test(w)&&
        8<f||8==f&&!/\bTrident\b/.test(a)))&&!C.test(p=e.call(n,a.replace(C,"")+";"))&&p.name&&(p="ing as "+p.name+((p=p.version)?" "+p:""),C.test(v)?(/\bIE\b/.test(p)&&"Mac OS"==w&&(w=null),p="identify"+p):(p="mask"+p,v=M?u(M.replace(/([a-z])([A-Z])/g,"$1 $2")):"Opera",/\bIE\b/.test(p)&&(w=null),G||(f=null)),A=["Presto"],g.push(p)):v+=" Mobile";if(p=(/\bAppleWebKit\/([\d.]+\+?)/i.exec(a)||0)[1]){p=[parseFloat(p.replace(/\.(\d)$/,".0$1")),p];if("Safari"==v&&"+"==p[1].slice(-1))v="WebKit Nightly",L="alpha",
        f=p[1].slice(0,-1);else if(f==p[1]||f==(p[2]=(/\bSafari\/([\d.]+\+?)/i.exec(a)||0)[1]))f=null;p[1]=(/\bChrome\/([\d.]+)/i.exec(a)||0)[1];537.36==p[0]&&537.36==p[2]&&28<=parseFloat(p[1])&&"WebKit"==A&&(A=["Blink"]);G&&(h||p[1])?(A&&(A[1]="like Chrome"),p=p[1]||(p=p[0],530>p?1:532>p?2:532.05>p?3:533>p?4:534.03>p?5:534.07>p?6:534.1>p?7:534.13>p?8:534.16>p?9:534.24>p?10:534.3>p?11:535.01>p?12:535.02>p?"13+":535.07>p?15:535.11>p?16:535.19>p?17:536.05>p?18:536.1>p?19:537.01>p?20:537.11>p?"21+":537.13>p?
            23:537.18>p?24:537.24>p?25:537.36>p?26:"Blink"!=A?"27":"28")):(A&&(A[1]="like Safari"),p=(p=p[0],400>p?1:500>p?2:526>p?3:533>p?4:534>p?"4+":535>p?5:537>p?6:538>p?7:601>p?8:"8"));A&&(A[1]+=" "+(p+="number"==typeof p?".x":/[.+]/.test(p)?"":"+"));"Safari"==v&&(!f||45<parseInt(f))&&(f=p)}"Opera"==v&&(p=/\bzbov|zvav$/.exec(w))?(v+=" ",g.unshift("desktop mode"),"zvav"==p?(v+="Mini",f=null):v+="Mobile",w=w.replace(RegExp(" *"+p+"$"),"")):"Safari"==v&&/\bChrome\b/.exec(A&&A[1])&&(g.unshift("desktop mode"),
            v="Chrome Mobile",f=null,/\bOS X\b/.test(w)?(E="Apple",w="iOS 4.3+"):w=null);f&&0==f.indexOf(p=/[\d.]+$/.exec(w))&&-1<a.indexOf("/"+p+"-")&&(w=String(w.replace(p,"")).replace(/^ +| +$/g,""));A&&!/\b(?:Avant|Nook)\b/.test(v)&&(/Browser|Lunascape|Maxthon/.test(v)||"Safari"!=v&&/^iOS/.test(w)&&/\bSafari\b/.test(A[1])||/^(?:Adobe|Arora|Breach|Midori|Opera|Phantom|Rekonq|Rock|Sleipnir|Web)/.test(v)&&A[1])&&(p=A[A.length-1])&&g.push(p);g.length&&(g=["("+g.join("; ")+")"]);E&&B&&0>B.indexOf(E)&&g.push("on "+
        E);B&&g.push((/^on /.test(g[g.length-1])?"":"on ")+B);w&&(p=/ ([\d.+]+)$/.exec(w)||(O=/^[a-z]+ ([\d.+]+) \//i.exec(w)),w={architecture:32,family:p&&!O?w.replace(p[0],""):w,version:p?p[1]:null,toString:function(){var c=this.version;return this.family+(c&&!O?" "+c:"")+(64==this.architecture?" 64-bit":"")}});(p=/\b(?:AMD|IA|Win|WOW|x86_|x)64\b/i.exec(K))&&!/\bi686\b/i.test(K)&&(w&&(w.architecture=64,w.family=w.family.replace(RegExp(" *"+p),"")),v&&(/\bWOW64\b/i.test(a)||G&&/\w(?:86|32)$/.test(D.cpuClass||
        D.platform)&&!/\bWin64; x64\b/i.test(a))&&g.unshift("32-bit"));a||(a=null);y={};y.description=a;y.layout=A&&A[0];y.manufacturer=E;y.name=v;y.prerelease=L;y.product=B;y.ua=a;y.version=v&&f;y.os=w||{architecture:null,family:null,version:null,toString:function(){return"null"}};y.parse=e;y.toString=function(){return this.description||""};y.version&&g.unshift(f);y.name&&g.unshift(v);w&&v&&(w!=String(w).split(" ")[0]||w!=v.split(" ")[0]&&!B)&&g.push(B?"("+w+")":"on "+w);g.length&&(y.description=g.join(" "));
        return y}var x={"function":!0,object:!0},d=x[typeof window]&&window||this,k=d,y=x[typeof h]&&h&&!h.nodeType&&h,x=x[typeof b]&&b&&y&&"object"==typeof m&&m;!x||x.global!==x&&x.window!==x&&x.self!==x||(d=x);var D=Math.pow(2,53)-1,C=/\bOpera/,J=this,x=Object.prototype,l=x.hasOwnProperty,I=x.toString;return e()}.call(b,a,b,h),void 0!==f&&(h.exports=f))}).call(b,a(96)(l),function(){return this}())},function(l,b){l.exports=function(a){a.webpackPolyfill||(a.deprecate=function(){},a.paths=[],a.children=[],
        a.webpackPolyfill=1);return a}},function(l,b,a){var f=a(1),h,m,g;l.exports={init:function(a,b,n){var u=a.indexOf("//");-1==u?h=a:(a=a.substr(u),h=window.location.protocol+a);f.flXHRproxy&&f.flXHRproxy.registerOptions(h,{xmlResponseText:!1});m=b;g=n},getApiUrl:function(){return h},getCommonParams:function(){return m},getErrorHandler:function(){return g}}},function(l,b,a){var f=a(99),h=a(100),m=a(97),g=a(1),r=a(103),u=function(a){var b=null;document.cookie&&(a=document.cookie.match(new RegExp("(^| )"+
        a+"\x3d([^;]*)(;|$)")),null!=a&&(b=decodeURIComponent(a[2])));return b};l.exports=function(a,b,t,c,q){var e=m.getCommonParams();e.xxzl_smartid&&(e.xxzl_smartid=u("xxzl_smartid")?u("xxzl_smartid"):"");var x=f[a];if(!x)return q("not found config.[api:"+a+"]");var d;"get"===x.method?(d=g.extend({},e,b),x.sign&&(d.content_sign=h(JSON.stringify(b)))):"post"===x.method&&(d=g.extend({},e),x.sign&&(d.content_sign=h(JSON.stringify(t))));a=m.getApiUrl()+"/"+x.url;var k=g.Deferred();r({url:a,method:x.method,
        datatype:"json",getparams:d,postparams:t},function(d){switch(d.error_code){case 0:c&&c(d.data);k.resolve(d.data);break;default:m.getErrorHandler()(d),q&&q(d),k.reject(d)}},function(c){q&&q(c);k.reject(c)});return k.promise()}},function(l,b){l.exports={init:{url:"user/init",method:"get"},get_userinfo:{url:"user/get_userinfo",method:"get"},get_userinfo_batch:{url:"user/get_user_info_batch",method:"post"},get_user_online_info:{url:"user/get_user_online_info",method:"get"},get_users_online_info:{url:"user/get_users_online_info",
        method:"get"},sendmsg:{url:"msg/sendmessage",method:"post",sign:!0},ack_msg_batch:{url:"msg/ack_msg_batch",method:"post"},ack_msg_read:{url:"msg/ack_msg_read",method:"post"},ack_msg_show:{url:"msg/ack_msg_show",method:"post"},get_session_list:{url:"msg/get_session_list",method:"get"},get_chat_records:{url:"msg/get_chat_records",method:"get"},get_unrecv_msgs:{url:"msg/get_unrecv_msgs",method:"get"},get_captcha:{url:"msg/get_captcha",method:"get"},validate_captcha:{url:"msg/validate_captcha",method:"get"}}},
    function(l,b,a){function f(a,b){for(var g="",f=0,r=a.length;f<r;f++)g+=a.charCodeAt(f)^b.charCodeAt(f);return g}var h=a(101),m=a(102).Base64;l.exports=function(a){var b=m.encode(a+"61e2e9e0d3e683bdfb96b66f60a07f31",!1),g="",n="",z="",t="";a=[];for(var c=0,q=b.length;c<q;c++)c<q/4?g+=b.charAt(c):c>=q/4&&c<q/4*2?n+=b.charAt(c):c>=q/4*2&&c<q/4*3?z+=b.charAt(c):t+=b.charAt(c);a.push(g);a.push(n);a.push(z);a.push(t);b=[];for(g=1;g<a.length;g++)b.push(f(a[0],a[g]));a="";for(g=0;g<b.length;g++)a+=b[g];return h(a+
        "61e2e9e0d3e683bdfb96b66f60a07f31")}},function(l,b,a){var f;!(f=function(a,b){function g(c,a,e,b,d,k){c=h(h(a,c),h(b,k));return h(c<<d|c>>>32-d,e)}function f(c,a,e,b,d,k,f){return g(a&e|~a&b,c,a,d,k,f)}function u(c,a,e,b,d,k,f){return g(a&b|e&~b,c,a,d,k,f)}function n(c,a,e,b,d,k,f){return g(e^(a|~b),c,a,d,k,f)}function h(c,a){var e=(c&65535)+(a&65535);return(c>>16)+(a>>16)+(e>>16)<<16|e&65535}var t=0;return function(c){var a;a="";for(var e=-1,b,d;++e<c.length;)b=c.charCodeAt(e),d=e+1<c.length?c.charCodeAt(e+
        1):0,55296<=b&&56319>=b&&56320<=d&&57343>=d&&(b=65536+((b&1023)<<10)+(d&1023),e++),127>=b?a+=String.fromCharCode(b):2047>=b?a+=String.fromCharCode(192|b>>>6&31,128|b&63):65535>=b?a+=String.fromCharCode(224|b>>>12&15,128|b>>>6&63,128|b&63):2097151>=b&&(a+=String.fromCharCode(240|b>>>18&7,128|b>>>12&63,128|b>>>6&63,128|b&63));c=Array(a.length>>2);for(e=0;e<c.length;e++)c[e]=0;for(e=0;e<8*a.length;e+=8)c[e>>5]|=(a.charCodeAt(e/8)&255)<<e%32;a=8*a.length;c[a>>5]|=128<<a%32;c[(a+64>>>9<<4)+14]=a;a=1732584193;
        e=-271733879;b=-1732584194;d=271733878;for(var k=0;k<c.length;k+=16){var y=a,D=e,m=b,r=d;a=f(a,e,b,d,c[k+0],7,-680876936);d=f(d,a,e,b,c[k+1],12,-389564586);b=f(b,d,a,e,c[k+2],17,606105819);e=f(e,b,d,a,c[k+3],22,-1044525330);a=f(a,e,b,d,c[k+4],7,-176418897);d=f(d,a,e,b,c[k+5],12,1200080426);b=f(b,d,a,e,c[k+6],17,-1473231341);e=f(e,b,d,a,c[k+7],22,-45705983);a=f(a,e,b,d,c[k+8],7,1770035416);d=f(d,a,e,b,c[k+9],12,-1958414417);b=f(b,d,a,e,c[k+10],17,-42063);e=f(e,b,d,a,c[k+11],22,-1990404162);a=f(a,e,
            b,d,c[k+12],7,1804603682);d=f(d,a,e,b,c[k+13],12,-40341101);b=f(b,d,a,e,c[k+14],17,-1502002290);e=f(e,b,d,a,c[k+15],22,1236535329);a=u(a,e,b,d,c[k+1],5,-165796510);d=u(d,a,e,b,c[k+6],9,-1069501632);b=u(b,d,a,e,c[k+11],14,643717713);e=u(e,b,d,a,c[k+0],20,-373897302);a=u(a,e,b,d,c[k+5],5,-701558691);d=u(d,a,e,b,c[k+10],9,38016083);b=u(b,d,a,e,c[k+15],14,-660478335);e=u(e,b,d,a,c[k+4],20,-405537848);a=u(a,e,b,d,c[k+9],5,568446438);d=u(d,a,e,b,c[k+14],9,-1019803690);b=u(b,d,a,e,c[k+3],14,-187363961);
            e=u(e,b,d,a,c[k+8],20,1163531501);a=u(a,e,b,d,c[k+13],5,-1444681467);d=u(d,a,e,b,c[k+2],9,-51403784);b=u(b,d,a,e,c[k+7],14,1735328473);e=u(e,b,d,a,c[k+12],20,-1926607734);a=g(e^b^d,a,e,c[k+5],4,-378558);d=g(a^e^b,d,a,c[k+8],11,-2022574463);b=g(d^a^e,b,d,c[k+11],16,1839030562);e=g(b^d^a,e,b,c[k+14],23,-35309556);a=g(e^b^d,a,e,c[k+1],4,-1530992060);d=g(a^e^b,d,a,c[k+4],11,1272893353);b=g(d^a^e,b,d,c[k+7],16,-155497632);e=g(b^d^a,e,b,c[k+10],23,-1094730640);a=g(e^b^d,a,e,c[k+13],4,681279174);d=g(a^e^
                b,d,a,c[k+0],11,-358537222);b=g(d^a^e,b,d,c[k+3],16,-722521979);e=g(b^d^a,e,b,c[k+6],23,76029189);a=g(e^b^d,a,e,c[k+9],4,-640364487);d=g(a^e^b,d,a,c[k+12],11,-421815835);b=g(d^a^e,b,d,c[k+15],16,530742520);e=g(b^d^a,e,b,c[k+2],23,-995338651);a=n(a,e,b,d,c[k+0],6,-198630844);d=n(d,a,e,b,c[k+7],10,1126891415);b=n(b,d,a,e,c[k+14],15,-1416354905);e=n(e,b,d,a,c[k+5],21,-57434055);a=n(a,e,b,d,c[k+12],6,1700485571);d=n(d,a,e,b,c[k+3],10,-1894986606);b=n(b,d,a,e,c[k+10],15,-1051523);e=n(e,b,d,a,c[k+1],21,
                -2054922799);a=n(a,e,b,d,c[k+8],6,1873313359);d=n(d,a,e,b,c[k+15],10,-30611744);b=n(b,d,a,e,c[k+6],15,-1560198380);e=n(e,b,d,a,c[k+13],21,1309151649);a=n(a,e,b,d,c[k+4],6,-145523070);d=n(d,a,e,b,c[k+11],10,-1120210379);b=n(b,d,a,e,c[k+2],15,718787259);e=n(e,b,d,a,c[k+9],21,-343485551);a=h(a,y);e=h(e,D);b=h(b,m);d=h(d,r)}c=[a,e,b,d];a="";for(e=0;e<32*c.length;e+=8)a+=String.fromCharCode(c[e>>5]>>>e%32&255);c=a;try{t}catch(F){t=0}a=t?"0123456789ABCDEF":"0123456789abcdef";e="";for(d=0;d<c.length;d++)b=
            c.charCodeAt(d),e+=a.charAt(b>>>4&15)+a.charAt(b&15);return e}}.call(b,a,b,l),void 0!==f&&(l.exports=f))},function(l,b){(function(a){var b=a.Base64,h=function(a){for(var c={},d=0,b=a.length;d<b;d++)c[a.charAt(d)]=d;return c}("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"),m=String.fromCharCode,g=function(a){if(2>a.length){var c=a.charCodeAt(0);return 128>c?a:2048>c?m(192|c>>>6)+m(128|c&63):m(224|c>>>12&15)+m(128|c>>>6&63)+m(128|c&63)}c=65536+1024*(a.charCodeAt(0)-55296)+(a.charCodeAt(1)-
            56320);return m(240|c>>>18&7)+m(128|c>>>12&63)+m(128|c>>>6&63)+m(128|c&63)},r=/[\uD800-\uDBFF][\uDC00-\uDFFFF]|[^\x00-\x7F]/g,u=function(a){return a.replace(r,g)},n=function(a){var c=[0,2,1][a.length%3];a=a.charCodeAt(0)<<16|(1<a.length?a.charCodeAt(1):0)<<8|(2<a.length?a.charCodeAt(2):0);return["ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(a>>>18),"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(a>>>12&63),2<=c?"\x3d":"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(a>>>
            6&63),1<=c?"\x3d":"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(a&63)].join("")},l=a.btoa?function(c){return a.btoa(c)}:function(a){return a.replace(/[\s\S]{1,3}/g,n)},t=function(a,c){return c?l(u(String(a))).replace(/[+\/]/g,function(a){return"+"==a?"-":"_"}).replace(/=/g,""):l(u(String(a)))},c=/[\u00c0-\u00df][\u0080-\u00bf]|[\u00e0-\u00ef][\u0080-\u00bf]{2}|[\u00f0-\u00f7][\u0080-\u00bf]{3}/g,q=function(a){switch(a.length){case 4:return a=((7&a.charCodeAt(0))<<18|(63&
            a.charCodeAt(1))<<12|(63&a.charCodeAt(2))<<6|63&a.charCodeAt(3))-65536,m((a>>>10)+55296)+m((a&1023)+56320);case 3:return m((15&a.charCodeAt(0))<<12|(63&a.charCodeAt(1))<<6|63&a.charCodeAt(2));default:return m((31&a.charCodeAt(0))<<6|63&a.charCodeAt(1))}},e=function(a){return a.replace(c,q)},x=function(a){var c=a.length,d=c%4;a=(0<c?h[a.charAt(0)]<<18:0)|(1<c?h[a.charAt(1)]<<12:0)|(2<c?h[a.charAt(2)]<<6:0)|(3<c?h[a.charAt(3)]:0);a=[m(a>>>16),m(a>>>8&255),m(a&255)];a.length-=[0,0,2,1][d];return a.join("")},
        d=a.atob?function(c){return a.atob(c)}:function(a){return a.replace(/[\s\S]{1,4}/g,x)},k=function(a){return e(d(String(a).replace(/[-_]/g,function(a){return"-"==a?"+":"/"}).replace(/[^A-Za-z0-9\+\/]/g,"")))};a.Base64={VERSION:"2.1.9",atob:d,btoa:l,fromBase64:k,toBase64:t,utob:u,encode:t,encodeURI:function(a){return t(a,!0)},btou:e,decode:k,noConflict:function(){var c=a.Base64;a.Base64=b;return c}};if("function"===typeof Object.defineProperty){var y=function(a){return{value:a,enumerable:!1,writable:!0,
        configurable:!0}};a.Base64.extendString=function(){Object.defineProperty(String.prototype,"fromBase64",y(function(){return k(this)}));Object.defineProperty(String.prototype,"toBase64",y(function(a){return t(this,a)}));Object.defineProperty(String.prototype,"toBase64URI",y(function(){return t(this,!0)}))}}})(this)},function(l,b,a){var f=a(104),h=a(1);l.exports=function(a,b,r){var g=h.param(a.getparams),n=a.postparams&&JSON.stringify(a.postparams),g=a.url+"?"+g;n&&(n=f(n));(new Date).getTime();h.ajax({url:g,
        type:a.method,data:n,dataType:a.datatype,contentType:"text/plain;charset\x3dUTF-8",beforeSend:function(b,g){b=f(g.url.split("?")[1]);g.url=a.url+"?params\x3d"+b+"\x26version\x3d"+f.getVersion()},success:function(a){b(a)},error:function(a,b,c){r(c)},complete:function(a,b){(new Date).getTime();void 0}})}},function(l,b,a){var f=a(102).Base64;b=function(a){if(null==a||0==a.length)return"";a=f.encode(a);var b=0,g=a.indexOf("\x3d");-1!==g&&(b=a.length-g,a=a.substring(0,g));a=(a+b).replace(/\+/g,"-").replace(/\//g,
        "_");g=Math.floor(a.length/2);b=a.substring(g);a=a.substring(0,g);return b+a};b.getVersion=function(){return"j1.0"};l.exports=b},function(l,b,a){var f=a(1),h=a(98),m=a(5);b=a(106);var g=b.msg,r=b.unreadmsg,u=a(57),n=a(125),z=a(107),t=a(84).get(),c=!1,q=0,e={},x=function(a){if(!a||!a.invitation)return null;var c=function(a){return a?a.toString():""},d=a.invitation;d.id=c(d.id);d.title=c(d.title);d.url=c(d.url);d.rootcateid=c(d.rootcateid);d.cateid=c(d.cateid);d.role=c(d.role);d.scene=c(d.scene);return a};
        a=function(){m.call(this);this._unread={};this._msgList={};this._unreadTimer=null};a.prototype=Object.create(m.prototype);a.prototype.start=function(){var a=this;"web"==t&&(a._unreadTimer=new u({onElapsed:function(c){var d=(new Date).getTime();r.getAll(function(b){if(d<q)return c();var e=!1,k={};f.each(b,function(c,d){var b=a._unread[c];(b?b:0)!=d&&(a._unread[c]=d,k[c]=d,e=!0)});e&&a.triggerEvent("unreadChanged",k);c()},function(d){void 0;a._unreadTimer.setDuration(0);c()})},duration:500}),a._unreadTimer.start());
            g.getAllRefer(function(c){f.each(c,function(c,d){var b=c.split("@")[0],k=c.split("@")[1],f=e[c];if(!f||!f.invitation||f.invitation.id&&f.invitation.id.toString()!==d.invitation.id.toString()&&f.invitation.refer_time<d.invitation.refer_time)e[c]=d,a.triggerEvent("referChanged",{refer:d,user_id:b,user_source:k})})})};a.prototype.stop=function(){this._unreadTimer&&this._unreadTimer.stop()};a.prototype.addMsgToDB=function(a,c,b){void 0;g.add(a,function(){c&&c()},function(a){void 0;b&&b()})};a.prototype.addUnreadMsgToDB=
            function(a,b,e){var d=this;c?setTimeout(function(){d.addUnreadMsgToDB(a,b,e)},5):(c=!0,r.add(a,function(){c=!1;b&&b()},function(a){void 0;c=!1;e&&e()}))};a.prototype.setUnreadToZero=function(a,b,e){var d=this;if(c)setTimeout(function(){d.setUnreadToZero(a,b)},5);else{var k=n.get();d.ackShown({sender_id:a,sender_source:b,msg_ids:[e],to_id:k.user_id,to_source:k.user_source});c=!0;e=a+"@"+b;d._unread[e]&&0!=d._unread[e]?(d._unread[e]=0,k={},k[e]=0,d.triggerEvent("unreadChanged",k),q=(new Date).getTime(),
            r.update(e,0,function(){void 0;c=!1},function(a){void 0;void 0;c=!1})):c=!1}};a.prototype.send=function(a,c,b){var d=this;h("sendmsg",null,a,function(b){a.msg_id=b.msg_id;a.send_time=b.send_time;a.link_msg_id=b.link_msg_id;"web"==t&&d.addMsgToDB([a]);c(b)},b)};a.prototype.ackMsgBatch=function(a,c,b){h("ack_msg_batch",null,a,c,function(){h("ack_msg_batch",null,a,c,b)})};a.prototype.ackRead=function(a,c,b){h("ack_msg_read",null,a,c,b)};a.prototype.ackShown=function(a,c,b){h("ack_msg_show",null,a,c,
            b)};a.prototype.getUnrecvMsgs=function(a,c,b){h("get_unrecv_msgs",a,null,c,b)};a.prototype.saveMsgs=function(a){0!=a.length&&(this.updateCacheMsgList(a),"web"==t&&this.addMsgToDB(a))};a.prototype.saveUnreadNum=function(a){for(var c={},b=0;b<a.length;b++){var d=a[b].contact,e=a[b].num;this._unread[d]=this._unread[d]?this._unread[d]+e:e;c[d]=this._unread[d]}this.triggerEvent("unreadChanged",c);q=(new Date).getTime();this.addUnreadMsgToDB(a)};a.prototype.getMsgRecords=function(a,c,b){var d=this,e=n.get();
            if(a.user_id==e.user_id&&a.user_source==e.user_source)return c([]);var k=function(a,c,b){if(a.localonly||1==a.option&&null!=a.msg_id)a={sender_id:a.user_id,sender_source:a.user_source,to_id:n.get().user_id,to_source:n.get().user_source,msgid:a.msg_id,count:a.count,option:a.option},g.find(a,function(a){d.updateCacheMsgList(a);return c(a)},function(a){void 0;b&&b(a)});else if(-1==a.option)d.getMsgRecordsRemote({chat_user_id:a.user_id,chat_user_source:a.user_source,count:a.count,last_min_msg_id:a.msg_id?
                a.msg_id:0},function(a){c(a)},b);else return c([])},f=function(){var a=[];return function(c,b,e){k(c,function(k){var g=[];if(0===k.length)return b(a);for(var t=0,q=k.length;t<q;t++){var y=k[t];d.isNeedShow(y)&&g.push(y)}Array.prototype.push.apply(a,g);a.length>=k.length?b(a.slice(0,k.length)):(c.msg_id=(1==c.option?k[0]:k[k.length-1]).msg_id,f(c,b,e))},function(a){e&&e(a)})}}();f(a,c,b)};a.prototype.getMsgRecordsRemote=function(a,c,b){h("get_chat_records",a,null,function(a){var b=a.msg_list.length;
            if(0==b)return c(a.msg_list);for(var d=0;d<b;d++)"string"==typeof a.msg_list[d].content&&(a.msg_list[d].content=JSON.parse(a.msg_list[d].content));c(a.msg_list)},b)};a.prototype.syncAppMsgRecords=function(a){this.updateCacheMsgList([a]);var c=n.get().user_id+"_"+n.get().user_source+"@"+a.to_id+"_"+a.to_source,c=this._msgList[c],c=1<c.length?c[c.length-2].msg_id:null;a.link_msg_id!=c&&this.loopHandleSynAppMsg(a,c)};a.prototype.loopHandleSynAppMsg=function(a,c){var b=this,d=0,e=[],k=!1,f={chat_user_id:a.to_id,
            chat_user_source:a.to_source,count:20,last_min_msg_id:a.last_min_msg_id},g=function(){5>d?b.getMsgRecordsRemote(f,function(a){if(0!=a.length){for(var b=0;b<a.length;b++)if(a[b].msg_id!=c)e.unshift(a[b]);else{k=!0;break}k?d=5:(d++,f.last_min_msg_id=e[0].msg_id);g()}},function(){void 0}):b.saveSynAppMsg(a,c,k,e)};g()};a.prototype.saveSynAppMsg=function(a,c,b,e){var d=this,k=n.get().user_id+"_"+n.get().user_source+"@"+a.to_id+"_"+a.to_source;b?(d.updateCacheMsgList(e),d.addMsgToDB(e,function(){void 0;
            d.triggerEvent("syncAppData",{msglist:e,user_id:a.to_id,user_source:a.to_source,delete_msg_id:null})},function(){void 0})):(void 0,d._msgList[k].splice(0,d._msgList[k].length-1),d.updateCacheMsgList(e),d.removeOld({talk:k,msgid:c,count:null,is_close_range:!0},function(){d.addMsgToDB(e,function(){void 0;d.triggerEvent("syncAppData",{msglist:e,user_id:a.to_id,user_source:a.to_source,delete_msg_id:c})},function(){void 0})}))};a.prototype.getAllUnreadAmount=function(){return this._unread};a.prototype.updateCacheMsgList=
            function(a){for(var c=0;c<a.length;c++){var b=a[c],d=b.to_id==n.get().user_id&&b.to_source==n.get().user_source?n.get().user_id+"_"+n.get().user_source+"@"+b.sender_id+"_"+b.sender_source:n.get().user_id+"_"+n.get().user_source+"@"+b.to_id+"_"+b.to_source;this._msgList[d]?this.insert(this._msgList[d],b):this._msgList[d]=[b]}};a.prototype.insert=function(a,c){var b=-1,d=a.length,e=c.msg_id;if(0==d||e<a[0].msg_id)b=0;else if(e>a[d-1].msg_id)b=d;else for(var k=0;k<d;k++)if(a[k].msg_id<e&&a[k+1].msg_id>
            e){b=k+1;break}else if(a[k].msg_id==e){b=-1;break}-1!=b&&a.splice(b,0,c)};a.prototype.clearAll=function(a,c){g.clearAll(function(){r.clearAll(function(){a&&a()},function(a){void 0;c&&c(a)})},function(a){void 0;c&&c(a)})};a.prototype.removeOld=function(a,c,b){g.removeOld(a,function(){c&&c()},function(a){void 0;b&&b()})};a.prototype.isNeedShow=function(a){var c=n.get(),b;if(a.options&&a.options.show_in_app&&0!=a.options.show_in_app.length){b=!1;for(var d=z.appid.split("-")[0],e=0,f=a.options.show_in_app.length;e<
        f;e++)if(a.options.show_in_app[e]==d){b=!0;break}}else b=!0;a.sender_id+""===c.user_id+""&&a.sender_source+""===c.user_source+""&&a.options&&a.options.sender_hide&&"1"===a.options.sender_hide.toString()&&(b=!1);return b};a.prototype.setRefer=function(a,c,b){var d=this,k=a+"@"+c,f=e[k];if(!f||!f.invitation||f.invitation.id&&f.invitation.id.toString()!==b.invitation.id.toString()&&parseInt(f.invitation.refer_time)<parseInt(b.invitation.refer_time.toString()))b=x(b),g.setRefer(b,k,function(){e[k]=b;
            d.triggerEvent("referChanged",{refer:b,user_id:a,user_source:c})})};a.prototype.getRefer=function(a,c){a=a+"@"+c;e[a]=x(e[a]);return e[a]?e[a]:null};l.exports=new a},function(l,b,a){var f=a(107);b=a(95);var h=a(83),m={},g=window.indexedDB?"indexedDB":window.localStorage?"localStorage":"userData";"Firefox"===b.name?g="localStorage":"Safari"===b.name&&(g="localStorage");"indexedDB"==g?(m.msg=a(108),m.session=a(110),m.syn=a(111),m.unreadmsg=a(112),m.init=function(){}):"localStorage"==g?(m.msg=a(113),
        m.session=a(114),m.syn=a(115),m.unreadmsg=a(116),m.init=function(){var a=window.localStorage.getItem(f.prefix_name+"-version");a?(a=JSON.parse(a),f.storage_version!=a&&(m.msg.clearAll(),m.session.clearAll(),m.syn.clearAll(),m.unreadmsg.clearAll())):window.localStorage.setItem(f.prefix_name+"-version",JSON.stringify(f.storage_version))}):"userData"==g&&(m.msg=a(117),m.session=a(119),m.syn=a(121),m.unreadmsg=a(123),m.init=function(){var a=f.prefix_name+"-version",b=h(a);b.load(a);var g=b.getAttribute(f.prefix_name+
            "-version");g?(g=JSON.parse(g),f.storage_version!=g&&(m.msg.clearAll(function(){void 0}),m.session.clearAll(function(){void 0}),m.syn.clearAll(function(){void 0}),m.unreadmsg.clearAll(function(){void 0}))):(b.setAttribute(f.prefix_name+"-version",JSON.stringify(f.storage_version)),b.save(a))});l.exports=m},function(l,b){l.exports={prefix_name:"webim",storage_version:12,appid:null,"audio-converter":function(a){var b;"string"===typeof a&&-1<a.indexOf("audioconvert.58.com")?0===a.indexOf("http://audioconvert.58.com")?
        b=a.replace("http","https"):0===a.indexOf("//audioconvert.58.com")?b="https:"+a:0===a.indexOf("audioconvert.58.com")?b="https://"+a:0===a.indexOf("https://audioconvert.58.com")&&(b=a):b="https://audioconvert.58.com/convert?amrurl\x3d"+encodeURIComponent(a);return b}}},function(l,b,a){var f=a(109),h=0;b=function(){};var m=function(a,c,b){f.createTransaction("msg","readonly",function(e){e=e.objectStore("msg");var f=[];if(a.msgid){var d=IDBKeyRange.lowerBound(a.msgid,!0);e=e.index("msg_id").openCursor(d)}else e=
        e.index("msg_id").openCursor();e.onsuccess=function(b){if((b=b.target.result)&&b.value){var d=b.value,e=d.to_id+"@"+d.to_source+"_"+d.sender_id+"@"+d.sender_source;if(a.talk==d.sender_id+"@"+d.sender_source+"_"+d.to_id+"@"+d.to_source||a.talk==e)1===a.option?f.push(d):-1===a.option&&f.unshift(d);if(a.count&&f.length==a.count)c&&c(f);else b["continue"]()}else c&&c(f)};e.onerror=function(a){b&&b(a)}})},g=function(a,c,b){f.createTransaction("msg","readonly",function(e){e=e.objectStore("msg");var f=[];
        if(a.msgid){var d=IDBKeyRange.upperBound(a.msgid,!0);e=e.index("msg_id").openCursor(d,"prev")}else e=e.index("msg_id").openCursor(null,"prev");e.onsuccess=function(b){if((b=b.target.result)&&b.value){var d=b.value,e=d.to_id+"@"+d.to_source+"_"+d.sender_id+"@"+d.sender_source;if(a.talk==d.sender_id+"@"+d.sender_source+"_"+d.to_id+"@"+d.to_source||a.talk==e)1===a.option?f.push(d):-1===a.option&&f.unshift(d);if(a.count&&f.length==a.count)c&&c(f);else b["continue"]()}else c&&c(f)};e.onerror=function(a){b&&
        b(a)}})},r=function(a,c,b){f.createTransaction("msg","readonly",function(e){e=e.objectStore("msg");var f,d=[];f=a.is_close_range?!1:!0;a.msgid?(f=IDBKeyRange.upperBound(a.msgid,f),e=e.index("msg_id").openCursor(f,"prev")):e=e.index("msg_id").openCursor(null,"prev");e.onsuccess=function(b){if((b=b.target.result)&&b.value){var e=b.value,k=e.to_id+"@"+e.to_source+"_"+e.sender_id+"@"+e.sender_source;if(a.talk==e.sender_id+"@"+e.sender_source+"_"+e.to_id+"@"+e.to_source||a.talk==k)1===a.option?d.push(e):
        -1===a.option&&d.unshift(e);if(a.count&&d.length==a.count)c&&c(d);else b["continue"]()}else c&&c(d)};e.onerror=function(a){b&&b(a)}})},u=function(a,c,b){f.createTransaction("msg","readwrite",function(e){e=e.objectStore("msg")["delete"](a.msg_id);e.onsuccess=function(){c&&c()};e.onerror=function(a){b&&b(a)}})},n=function(a,c,b){f.createTransaction("msg","readwrite",function(e){e=e.objectStore("msg").put(a);e.onsuccess=function(){c&&c()};e.onerror=function(a){b&&b(a)}})},z=function(a,c){f.createTransaction("refer",
        "readonly",function(b){b=b.objectStore("refer").index("contact").openCursor();var e={};b.onsuccess=function(c){(c=c.target.result)?(e[c.value.contact]=c.value.refer,c["continue"]()):a&&a(e)};b.onerror=function(a){c&&c(a)}})};b.prototype.add=function(a,c,b){var e=0,f=function(){if(e<a.length){var d=a[e];void 0;n(d,function(){void 0;h++;e++;f()},function(a){b&&b(a)})}else void 0,c&&c()};f()};b.prototype.find=function(a,c,b){a.talk=a.sender_id+"@"+a.sender_source+"_"+a.to_id+"@"+a.to_source;1==a.option?
        m(a,function(a){c&&c(a)},b):-1==a.option&&g(a,function(a){c&&c(a)},b)};b.prototype.removeOld=function(a,c,b){var e=0;r(a,function(a){void 0;var b=function(){e<a.length?u(a[e],function(){e++;b()},function(){b()}):c&&c()};b()},b)};b.prototype.clearAll=function(a,c){f.createTransaction("msg","readwrite",function(b){b=b.objectStore("msg").clear();b.onsuccess=function(b){f.createTransaction("refer","readwrite",function(b){b=b.objectStore("refer").clear();b.onsuccess=function(c){a&&a()};b.onerror=function(a){c&&
    c(a)}})};b.onerror=function(a){c&&c(a)}})};b.prototype.setRefer=function(a,c,b,e){var g={refer:a,contact:c};f.createTransaction("refer","readwrite",function(a){a=a.objectStore("refer").put(g);a.onsuccess=function(){b&&b()};a.onerror=function(a){e&&e(a)}})};b.prototype.getRefer=function(a,c,b){f.createTransaction("refer","readonly",function(e){e=e.objectStore("refer").get(a);e.onsuccess=function(a){a.target.result?c&&c(a.target.result.refer):c&&c(null)};e.onerror=function(a){b&&b(a)}})};b.prototype.getAllRefer=
        function(a,c){z(function(c){a&&a(c)},function(a){c&&c(a)})};l.exports=new b},function(l,b,a){var f=a(107);b=function(){this._db=this._version=this._dbname=null};b.prototype.init=function(a){this._dbname=a.dbname;this._version=a.version};b.prototype.open=function(a,b){if(this._db)return a&&a(this._db);var g=this;g.init({dbname:f.prefix_name,version:f.storage_version});var h=window.indexedDB.open(this._dbname,this._version);h.onsuccess=function(b){g._db=b.target.result;a&&a(g._db)};h.onerror=function(a){b&&
    b(a)};h.onupgradeneeded=function(a){a=a.target.result;a.objectStoreNames.contains("msg")||a.createObjectStore("msg",{keyPath:"msg_id"}).createIndex("msg_id","msg_id",{unique:!0});if(!a.objectStoreNames.contains("unreadmsg")){var b=a.createObjectStore("unreadmsg",{keyPath:"contact"});b.createIndex("contact","contact",{unique:!0})}a.objectStoreNames.contains("refer")||(b=a.createObjectStore("refer",{keyPath:"contact"}),b.createIndex("contact","contact",{unique:!0}));a.objectStoreNames.contains("session")||
    a.createObjectStore("session",{keyPath:"userKey"}).createIndex("userKey","userKey",{unique:!0});a.objectStoreNames.contains("syn")||a.createObjectStore("syn",{keyPath:"name"})}};b.prototype.createTransaction=function(a,b,f,r){this.open(function(g){g=g.transaction(a,b);f&&f(g)},function(a){r&&r(a)})};b.prototype.clearAll=function(a,b){var f=["msg","session","unreadmsg","syn","refer"],h=0,u=this,n=function(){h<f.length?u.createTransaction(f[h],"readwrite",function(a){a.objectStore(f[h]).clear();h++;
        n()}):a&&a()};n()};l.exports=new b},function(l,b,a){var f=a(109);b=function(){};var h=function(a,b){f.createTransaction("session","readonly",function(f){f=f.objectStore("session").index("userKey").openCursor();f.onsuccess=function(b){(b=b.target.result)?(a&&a(b),b["continue"]()):a&&a()};f.onerror=function(a){b&&b(a)}})},m=function(a,b,u){f.createTransaction("session","readwrite",function(f){f=f.objectStore("session").put(a);f.onsuccess=function(){b&&b()};f.onerror=function(a){u&&u(a)}})};b.prototype.add=
        function(a,b,f){var g=0,h=function(){if(g<a.length){var t=a[g];t.userKey=t.user.user_id+"@"+t.user.user_source;m(t,function(){g++;h()},function(a){f&&f(a)})}else b&&b()};h()};b.prototype.getAll=function(a,b){var f=[],g={};h(function(b){b?(b=b.value,g[b.userKey]||(f.push(b),g[b.userKey]=!0)):a&&a(f)},function(a){b&&b(a)})};b.prototype.clearAll=function(a,b){f.createTransaction("session","readwrite",function(f){f=f.objectStore("session").clear();f.onsuccess=function(){a&&a()};f.onerror=function(a){b&&
    b(a)}})};l.exports=new b},function(l,b,a){var f=a(109);b=function(){};var h=function(a,b,h){f.createTransaction("syn","readwrite",function(f){f=f.objectStore("syn").put(a);f.onsuccess=function(){b&&b()};f.onerror=function(a){h&&h(a)}})};b.prototype.set=function(a,b,f){h(a,function(){b&&b()},function(a){f&&f(a)})};b.prototype.get=function(a,b,h){f.createTransaction("syn","readonly",function(f){f=f.objectStore("syn").get(a);f.onsuccess=function(a){a.target.result?b&&b(a.target.result.value):b&&b(null)};
        f.onerror=function(a){h&&h(a)}})};b.prototype.clearAll=function(a,b){f.createTransaction("syn","readwrite",function(f){f=f.objectStore("syn").clear();f.onsuccess=function(b){a&&a()};f.onerror=function(a){b&&b(a)}})};l.exports=new b},function(l,b,a){var f=a(109);b=function(){};var h=function(a,b){f.createTransaction("unreadmsg","readonly",function(f){f=f.objectStore("unreadmsg").index("contact").openCursor();var g={};f.onsuccess=function(b){(b=b.target.result)?(g[b.value.contact]=b.value.num,b["continue"]()):
        a&&a(g)};f.onerror=function(a){b&&b(a)}})},m=function(a,b,g){f.createTransaction("unreadmsg","readwrite",function(f){f=f.objectStore("unreadmsg").add(a);f.onsuccess=function(a){b&&b(a.target.result)};f.onerror=function(a){g&&g(a)}})},g=function(a,b,g){f.createTransaction("unreadmsg","readonly",function(f){f=f.objectStore("unreadmsg").get(a);f.onsuccess=function(a){a.target.result?b&&b(a.target.result):b&&b(null)};f.onerror=function(a){g&&g(a)}})},r=function(a,b,g,h){f.createTransaction("unreadmsg",
        "readwrite",function(c){var f=c.objectStore("unreadmsg");c=f.get(a);c.onsuccess=function(a){a=a.target.result;a.num+=b;f.put(a);g&&g(a.num)};c.onerror=function(a){h&&h(a)}})};b.prototype.add=function(a,b,f){var h=0,c=function(){if(h<a.length){var q=a[h].contact,e=a[h].num;g(q,function(b){b?r(q,e,function(){h++;c()},function(a){f&&f(a)}):m(a[h],function(){h++;c()},function(a){f&&f(a)})},function(a){f&&f(a)})}else b&&b()};c()};b.prototype.update=function(a,b,g,h){f.createTransaction("unreadmsg","readwrite",
        function(c){var f=c.objectStore("unreadmsg");c=f.get(a);c.onsuccess=function(a){(a=a.target.result)?(a.num=b,f.put(a),g&&g(a.num)):g&&g()};c.onerror=function(a){h&&h(a)}})};b.prototype.getAll=function(a,b){h(function(b){a&&a(b)},function(a){b&&b(a)})};b.prototype.clearAll=function(a,b){f.createTransaction("unreadmsg","readwrite",function(f){f=f.objectStore("unreadmsg").clear();f.onsuccess=function(b){a&&a()};f.onerror=function(a){b&&b(a)}})};l.exports=new b},function(l,b,a){b=a(107);var f=b.prefix_name+
        "-msg-ids",h=b.prefix_name+"-msg-",m=b.prefix_name+"-refer",g=window.localStorage,r=function(){var a=g.getItem(m);return a?JSON.parse(a):{}},u=function(){var a=g.getItem(f);return a?JSON.parse(a):[]},n=function(a){return(a=g.getItem(h+a))?JSON.parse(a):null},z=function(a){function b(a,b,c){if(!a)return!1;var d=a.to_id+"@"+a.to_source+"_"+a.sender_id+"@"+a.sender_source;if(c.talk==a.sender_id+"@"+a.sender_source+"_"+a.to_id+"@"+a.to_source||c.talk==d)1===c.option?b.push(a):-1===c.option&&b.unshift(a)}
        var f=a.is_close_range,e=a.msgid,g=a.option,d=[],k=u(),h=-1===k.indexOf(e)?0:k.indexOf(e),m=k.length,t=a.count;if(!e)if("1"==g)for(e=0;e<m&&e!=t-1;e++)g=n(k[e]),b(g,d,a);else{if("-1"==g)for(e=m;0<e&&m-e!=t;e--)g=n(k[e-1]),b(g,d,a)}else if(1==g){for(e=h;e<m&&e-h!=t;e++)g=n(k[e]),b(g,d,a);f||d.shift()}else if(-1==g){for(e=h;0<=e&&h-e!=t;e--)g=n(k[e]),b(g,d,a);f||d.pop()}return d};b=function(){};b.prototype.add=function(a,b,q){q=0;for(var c,m,d=u(),k;q<a.length;q++)c=a[q].msg_id,k=d.indexOf(c),m=a[q],
    -1===k&&(d.push(c),g.setItem(h+c,JSON.stringify(m)));d.sort(function(a,b){return a-b});g.setItem(f,JSON.stringify(d));b&&b()};b.prototype.find=function(a,b,f){a.talk=a.sender_id+"@"+a.sender_source+"_"+a.to_id+"@"+a.to_source;"undefined"==typeof a.is_close_range&&(a.is_close_range=!0);b(z(a))};b.prototype.removeOld=function(a,b,q){a.is_close_range=a.is_close_range||!0;q=0;a=z(a);for(var c=u(),m,d;q<a.length;q++)m=a[q].msg_id,d=c.indexOf(m),-1!==d&&(g.removeItem(h+m),c.splice(d,1));g.setItem(f,JSON.stringify(c));
        b&&b()};b.prototype.clearAll=function(a,b){b=0;for(var c=u(),e=c.length,n;b<e;b++)n=c[b],g.removeItem(h+n);g.removeItem(f);g.removeItem(m);a&&a()};b.prototype.setRefer=function(a,b,f,e){e=r();e[b]=a;g.setItem(m,JSON.stringify(e));f&&f()};b.prototype.getRefer=function(a,b,f){f=r();a=f[a]?f[a]:null;b&&b(a)};b.prototype.getAllRefer=function(a,b){b=r();a&&a(b)};l.exports=new b},function(l,b,a){b=a(107);var f=b.prefix_name+"-session-ids",h=b.prefix_name+"-session-",m=window.localStorage,g=function(){var a=
        m.getItem(f);return a?JSON.parse(a):[]},r=function(a){return(a=m.getItem(h+a))?JSON.parse(a):null};b=function(){};b.prototype.add=function(a,b,l){l=g();for(var n=0;n<a.length;n++){var c=a[n],q=c.user.user_id+"^"+c.user.user_source;r(q)||l.push(q);m.setItem(h+q,JSON.stringify(c))}m.setItem(f,JSON.stringify(l));b&&b(a.length)};b.prototype.getAll=function(a,b){b=[];for(var f=g(),h=0;h<f.length;h++){var c=r(f[h]);b.push(c)}a&&a(b)};b.prototype.clearAll=function(a,b){b=g();for(var n=0;n<b.length;n++)m.removeItem(h+
        b[n]);m.removeItem(f);a&&a()};l.exports=new b},function(l,b,a){var f=a(107).prefix_name+"-syn",h=window.localStorage,m=function(){var a=h.getItem(f);return a?JSON.parse(a):{}};b=function(){};b.prototype.set=function(a,b,l){l=m();l[a.name]=a.value;h.setItem(f,JSON.stringify(l));b&&b()};b.prototype.get=function(a,b,f){f=m();b&&b(f[a])};b.prototype.clearAll=function(a,b){h.removeItem(f);a&&a()};l.exports=new b},function(l,b,a){var f=a(107).prefix_name+"-unreadmsg",h=window.localStorage,m=function(){var a=
        h.getItem(f);return a?JSON.parse(a):{}};b=function(){};b.prototype.add=function(a,b,l){l=m();for(var g=0;g<a.length;g++){var r=a[g],t=r.contact;l[t]=(l[t]?l[t]:0)+r.num}h.setItem(f,JSON.stringify(l));b&&b(a.length)};b.prototype.update=function(a,b,l,n){n=m();n[a]=b;h.setItem(f,JSON.stringify(n));l&&l()};b.prototype.getAll=function(a,b){b=m();a&&a(b)};b.prototype.clearAll=function(a,b){h.removeItem(f);a&&a()};l.exports=new b},function(l,b,a){var f=a(118),h=a(83);b=a(107);var m=b.prefix_name+"-msg-ids",
        g=b.prefix_name+"-msg-",r=b.prefix_name+"-refer",u=function(){try{var a=h(r);a.load();var b=a.getAttribute("refer");return b?JSON.parse(b):{}}catch(e){void 0}},n=function(){try{var a=h(m);a.load();var b=a.getAttribute("ids");return b?JSON.parse(b):[]}catch(e){void 0}},z=function(a){a=h(g+a);a.load();a=a.getAttribute("msg");return JSON.parse(a)},t=function(a,b){var c=a.sender_id+"@"+a.sender_source,f=b.sender_id+"@"+b.sender_source;b=b.to_id+"@"+b.to_source;return c==f&&a.to==b||c==b&&a.to==f?!0:!1};
        b=function(){f.call(this)};b.prototype=Object.create(f.prototype);b.prototype.add=function(a,b,e){e=n();for(var c={},d=0,f=e.length;d<f;d++){var q=e[d];c[q]=!0}d=0;for(f=a.length;d<f;d++){var l=a[d],q=l.msg_id;c[q]||(c[q]=!0,e.push(q),q=h(g+q),q.load(),q.setAttribute("msg",JSON.stringify(l)),q.save())}e.sort(function(a,b){return a-b});a=h(m);a.load();a.setAttribute("ids",JSON.stringify(e));a.save();b&&b()};b.prototype.find=function(a,b,e){e=n();for(var c=-1,d=0,f=e.length;d<f;d++)if(e[d]==a.msgid){c=
            d;break}if(-1===c)b&&b([]);else if(1==a.option){for(var g=[],c=c+1,f=e.length;c<f;c++){var h=e[d];if((h=z(h))&&t(h,a)&&(g.push(h),g.length===a.count))break}b&&b(g)}else if(-1==a.option){g=[];for(--c;0<=c&&(h=e[d],!(h=z(h))||!t(h,a)||(g.unshift(h),g.length!==a.count));c--);b&&b(g)}};b.prototype.removeOld=function(a,b,e){e=n();for(var c=-1,d=0,f=e.length;d<f;d++)if(e[d]==a.msgid){c=d;break}if(-1===c)b&&b([]);else{f=[];for(d=0;d<c;d++){var l=e[d],q=z(l);q&&t(q,a)&&(f.push(d),h(g+l).clear())}for(a=f.length-
            1;0<=a;a--)l=f[a],e.splice(l,1);a=h(m);a.load();a.setAttribute("ids",JSON.stringify(e));a.save();b&&b()}};b.prototype.clearAll=function(a,b){b=n();for(var c=0,f=b.length;c<f;c++){var d=h(g+b[c]);d.removeAttribute("msg");d.save()}b=h(m);b.removeAttribute("ids");b.save();b.clear();b=h(r);b.removeAttribute("refer");b.save();b.clear();a&&a()};b.prototype.setRefer=function(a,b,e,f){f=u();f[b]=a;a=h(r);a.load();a.setAttribute("refer",JSON.stringify(f));a.save();e&&e()};b.prototype.getRefer=function(a,b,
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              e){e=u();a=e[a]?e[a]:null;b&&b(a)};b.prototype.getAllRefer=function(a,b){b=h(r);b.load();b=(b=b.getAttribute("refer"))?JSON.parse(b):{};a&&a(b)};l.exports=new b},function(l,b){b=function(){};b.prototype.add=function(a,b,h){};b.prototype.find=function(a,b,h){};b.prototype.removeOld=function(a,b,h){};b.prototype.clearAll=function(a,b){};b.prototype.setRefer=function(a,b,h,m){};b.prototype.getRefer=function(a,b,h){};b.prototype.getAllRefer=function(a,b){};l.exports=b},function(l,b,a){var f=a(120),h=
        a(83);b=a(107);var m=b.prefix_name+"-session-ids",g=b.prefix_name+"-session-",r=function(){var a=h(m);a.load();return(a=a.getAttribute("ids"))?JSON.parse(a):[]};b=function(){f.call(this)};b.prototype=Object.create(f.prototype);b.prototype.add=function(a,b,f){f=r();for(var l={},c=0,n=f.length;c<n;c++){var e=f[c];l[e]=!0}for(c=0;c<a.length;c++)n=a[c],e=n.user.user_id+"@"+n.user.user_source,l[e]||(l[e]=!0,f.push(e)),e=h(g+e),e.load(),e.setAttribute("session",JSON.stringify(n)),e.save();l=h(m);l.load();
        l.setAttribute("ids",JSON.stringify(f));l.save();b&&b(a.length)};b.prototype.getAll=function(a,b){b=[];for(var f=r(),l=0,c=f.length;l<c;l++){var m=h(g+f[l]);m.load();m=m.getAttribute("session");m=JSON.parse(m);b.push(m)}a&&a(b)};b.prototype.clearAll=function(a,b){b=r();for(var f=0;f<b.length;f++){var g=h(b[f]);g.removeAttribute("session");g.save()}b=h(m);b.removeAttribute("ids");b.save();b.clear();a&&a()};l.exports=new b},function(l,b){b=function(){};b.prototype.add=function(a,b,h){};b.prototype.getAll=
        function(a,b){};b.prototype.clearAll=function(a,b){};l.exports=b},function(l,b,a){var f=a(122),h=a(83),m=a(107).prefix_name+"-syn";b=function(){f.call(this)};b.prototype=Object.create(f.prototype);b.prototype.set=function(a,b,f){f=h(m);f.load();f.setAttribute(a.name,JSON.stringify(a.value));f.save();b&&b()};b.prototype.get=function(a,b,f){f=h(m);f.load();a=f.getAttribute(a);a=JSON.parse(a);b&&b(a)};b.prototype.clearAll=function(a,b){b=h(m);b.removeAttribute("loginInfo");b.removeAttribute("imToken");
        b.removeAttribute("comet");b.save();b.clear();a&&a()};l.exports=new b},function(l,b){b=function(){};b.prototype.set=function(a,b,h){};b.prototype.get=function(a,b,h){};b.prototype.clearAll=function(a,b){};l.exports=b},function(l,b,a){var f=a(124),h=a(83),m=a(107).prefix_name+"-unreadmsg";b=function(){f.call(this)};b.prototype=Object.create(f.prototype);b.prototype.add=function(a,b,f){f=h(m);f.load();for(var g=f.getAttribute("unreadmsgNum"),g=g?JSON.parse(g):{},l=0;l<a.length;l++){var r=a[l];g[r.contact]=
        g[r.contact]?r.num+g[r.contact]:r.num}f.setAttribute("unreadmsgNum",JSON.stringify(g));f.save();b&&b(a.length)};b.prototype.update=function(a,b,f,l){l=h(m);l.load();var g=l.getAttribute("unreadmsgNum"),g=g?JSON.parse(g):{};g[a]=b;l.setAttribute("unreadmsgNum",JSON.stringify(g));l.save();f&&f()};b.prototype.getAll=function(a,b){b=h(m);b.load();b=(b=b.getAttribute("unreadmsgNum"))?JSON.parse(b):{};a&&a(b)};b.prototype.clearAll=function(a,b){b=h(m);b.removeAttribute("unreadmsgNum");b.save();b.clear();
        a&&a()};l.exports=new b},function(l,b){b=function(){};b.prototype.add=function(a,b,h){};b.prototype.update=function(a,b,h,l){};b.prototype.getAll=function(a,b){};b.prototype.clearAll=function(a,b){};l.exports=b},function(l,b){var a="",f="";l.exports={set:function(b,l){a=b;f=l},get:function(){return{user_id:a,user_source:f}}}},function(l,b,a){var f=a(1);b=function(a){this._cdn=this._api=""};b.prototype.init=function(a){var b={api:"",cdn:"http://pic3.58cdn.com.cn"};f.extend(b,a);this._api=b.api;this._cdn=
        b.cdn};b.prototype.upload=function(a,b,g){-1!==a.indexOf(",")&&(a=a.split(",")[1]);var h=this;f.ajax({method:"POST",url:h._api,processData:!1,data:JSON.stringify({"Pic-Size":"0*0","Pic-Encoding":"base64","Pic-Path":"/nowater/webim/big/","Pic-Data":a}),headers:{"Content-Type":"text/plain"},success:function(a){a?b(h._cdn+"/nowater/webim/big/"+a):g("")},error:function(a){g(a)}})};l.exports=new b},function(l,b,a){var f=a(1),h=a(5),m=a(57),g=a(98),r=a(125);b=a(106);var u=a(84).get(),n=a(128),z=b.session,
        t=function(a,b){var c=-1;f.each(a,function(a,d){if(d.user&&b.user&&d.user.user_id==b.user.user_id&&d.user.user_source==b.user.user_source)return c=a,!1});return c},c=function(a,b){return a.sort_time>b.sort_time?-1:a.sort_time<b.sort_time?1:0},q=function(a,b){var c={last_other_id:null,last_other_source:null,last_msg_id:null,count:10,received_count:a.length},d;f.each(a,function(a,b){b.msg&&(d?d.msg.msg_id>b.msg.msg_id&&(d=b):d=b)});if(a=d?d.msg:null)c.last_other_id=d.user.user_id,c.last_other_source=
            d.user.user_source,c.last_msg_id=a.msg_id;g("get_session_list",c,null,function(a){f.each(a.session_list,function(a,b){(0<=b.msg_info.sender_id.indexOf("@")||0<=b.msg_info.to_id.indexOf("@"))&&void 0});var c=[];f.each(a.session_list,function(a,b){a=b.msg_info;-1==="1 2 3 7 8 9 13 14 15 16".split(" ").indexOf(a.msg_type.toString())||a.sender_id==a.to_id&&a.sender_source==a.to_source?a=null:(b=r.get(),a=b.user_id==a.sender_id&&b.user_source==a.sender_source?{user:{user_id:a.to_id,user_source:a.to_source},
            msg:{msg_id:a.msg_id,content:JSON.parse(a.content),send_time:a.send_time,msg_type:a.msg_type}}:b.user_id==a.to_id&&b.user_source==a.to_source?{user:{user_id:a.sender_id,user_source:a.sender_source},msg:{msg_id:a.msg_id,content:JSON.parse(a.content),send_time:a.send_time,msg_type:a.msg_type}}:null);a&&c.push(a)});b(c,1==a.have_more)},function(a){b([],!0)})},e=function(a){var b=[],c=!1,e=this;(function C(){q(b,function(d){var f=d.length;if(f&&e._sessions.length){var k=d[f-1].msg,g=function(){for(var a=
            null,b=0,c=e._sessions.length;b<c;b++){var d=e._sessions[b];if(d.msg){a=d.msg;break}}return a}();g&&k.msg_id<g.msg_id&&(c=!0)}b=b.concat(d);c||0===f||0===e._sessions.length?e.insert(b,function(){a&&a()}):C()})})()};a=function(){h.call(this);this._sessions=[];this._getSessionViaDBTimer=null;this._hasReadFromLocal=!1;(function(a){a._getSessionViaDBTimer=new m({onElapsed:function(b){z.getAll(function(d){d=d.sort(c);a.insert(d,function(){a._getSessionViaDBTimer.setDuration(1E3);b()})},function(c){void 0;
        a._getSessionViaDBTimer.setDuration(50);b()})},duration:1E3})})(this)};a.prototype=Object.create(h.prototype);a.prototype.start=function(){};a.prototype.stop=function(){this._getSessionViaDBTimer&&this._getSessionViaDBTimer.stop()};a.prototype.insert=function(){var a=arguments[0],b=1<arguments.length?arguments[1]:null,e=this,g=[],h=[];f.each(a instanceof Array?a:[a],function(a,b){b.msg?b.sort_time=b.msg.send_time:null==b.sort_time&&(b.sort_time=(new Date).getTime());a=t(e._sessions,b);-1===a?(g.push(b),
        e._sessions.push(b),h.push(b)):(a=e._sessions[a],a.sort_time<b.sort_time&&(g.push(b),a.sort_time=b.sort_time,a.msg=b.msg))});if(0===g.length)return b&&b();var l=[];f.each(g,function(a,b){b.msg&&b.msg.client_only&&"1"===b.msg.client_only.toString()||l.push(b)});0<l.length&&z.add(l,function(){b&&b()},function(a){void 0;b&&b()});this._sessions=e._sessions.sort(c);this.triggerEvent("changed",e.getAllSessions());0<h.length&&(this.triggerEvent("newSessionLoaded",n.MORE,h),void 0)};a.prototype.getSessions=
        function(a){var b=this;"wap"==u&&(b._hasReadFromLocal=!0);this._hasReadFromLocal?q(this._sessions,function(c,d){b.insert(c,function(){a(c,d)})}):z.getAll(function(d){d=d.sort(c);b._hasReadFromLocal=!0;b._sessions=d;b.triggerEvent("changed",b.getAllSessions());e.call(b,function(){b._getSessionViaDBTimer.start();a(d,!0)});b.triggerEvent("newSessionLoaded",n.FIRST,d);void 0},function(b){void 0;a([],!0)})};a.prototype.getAllSessions=function(){return f.extend(!0,[],this._sessions)};a.prototype.clearAll=
        function(a,b){this._sessions=[];z.clearAll(a,function(a){void 0;b&&b(a)})};a.prototype.getSession=function(a,b){for(var c=null,d=0,e=this._sessions.length;d<e;d++){var f=this._sessions[d],g=f.user;if(g.user_id==a&&g.user_source==b){c=f;break}}return c};l.exports=new a},function(l,b,a){b=a(14);l.exports=b({FIRST:null,MORE:null})},function(l,b,a){var f=a(1),h=a(98),m=a(5),g=a(57),r=a(106).syn,u=a(125),n=a(130),z=a(84).get(),t=a(128),c={},q={},e={},x={},d=function(a){a&&(a.avatar=n.convert(a.avatar+
        ""));return a};b=function(a){var b={getLoadedUsers:function(a){a([])}};f.extend(b,a);this._options=b;m.call(this);this._onlineTimer=null;(function(a){a._onlineTimer=new g({onElapsed:function(b){a._options.getLoadedUsers(function(c){c=c.slice(0,50);if(0===c.length)return a._onlineTimer.setDuration(1E4),b();a.getUsersOnlineInfo(c,function(c){a._onlineTimer.setDuration(12E5);b()},function(c){a._onlineTimer.setDuration(12E5);b()})})},duration:12E5})})(this)};b.prototype=Object.create(m.prototype);b.prototype.start=
        function(){};b.prototype.startOnlineTimer=function(){"web"==z&&this._onlineTimer.start()};b.prototype.stopOnlineTimer=function(){this._onlineTimer&&this._onlineTimer.stop()};b.prototype.stop=function(){this._onlineTimer&&this._onlineTimer.stop()};b.prototype.addUser=function(a){c[a.user_id+"@"+a.user_source]=a};b.prototype._setOnlineStatus=function(a,b,c){var d=a+"@"+b;e[d]=(new Date).getTime();q[d]!==c&&(q[d]=c,this.triggerEvent("onlineChanged",{user_id:a,user_source:b,is_online:c}))};b.prototype.getUserinfo=
        function(a,b,e){var f=a.target_user_id+"@"+a.target_user_source,g=c[f];if(g)return b(g);h("get_userinfo",a,null,function(a){a=d(a);c[f]=a;b(a)},e)};b.prototype.getUserinfos=function(a,b,e){var g={},k=[];f.each(a,function(a,b){a=b.user_id+"@"+b.user_source;c[a]?g[a]=c[a]:k.push(b.user_id+":"+b.user_source)});if(0===k.length)b(g);else{var l=Math.ceil(k.length/50),m=0;for(a=0;a<l;a++){var n=[],n=a===l-1?k.slice(50*a):k.slice(50*a,50*(a+1));h("get_userinfo_batch",null,{ids:n},function(a){f.each(a,function(a,
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   b){var e=a.split(":");a=e[0];e=e[1];b=d(b);g[a+"@"+e]=b;c[a+"@"+e]=b});m++;m===l&&b&&b(g)},e)}}};b.prototype.getUserOnlineInfo=function(a,b,c,d){var g=a+"@"+b;if(e[g]&&3E4>(new Date).getTime()-e[g])return c&&c(q[g]);if(x[g])x[g].then(function(a){c&&c(a)},function(a){d&&d(a)});else{var k=this,l=f.Deferred();h("get_user_online_info",{target_user_id:a,target_user_source:b},null,function(d){delete x[g];l.resolve(d.is_online);k._setOnlineStatus(a,b,d.is_online);c&&c(d.is_online)},function(a){delete x[g];
        l.reject(a);d&&d(a)});x[g]=l.promise()}};b.prototype.getUsersOnlineInfo=function(a,b,c){var d={},g=[],k=[];f.each(a,function(a,b){a=b.user_id+"@"+b.user_source;e[a]&&3E4>(new Date).getTime()-e[a]?d[a]=q[a]:x[a]?g.push({key:a,promise:x[a]}):k.push(b)});if(0===k.length)return b&&b(d);var l=this,m=function(){var a=0===g.length?1:2,c=0;return function(){c++;c===a&&b&&b(d)}}(),n=0,t=Math.ceil(k.length/50);for(a=0;a<t;a++){c=[];c=a===t-1?k.slice(50*a):k.slice(50*a,50*(a+1));void 0;var r=[];f.each(c,function(a,
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   b){r.push(b.user_id+"@@"+b.user_source)});var y=h("get_users_online_info",{target_users:r.join(",")},null,function(a){f.each(a.results,function(a,b){d[b.user_id+"@"+b.user_source]=b.is_online;l._setOnlineStatus(b.user_id,b.user_source,b.is_online)});n++;n===t&&m()},function(a){n++;n===t&&m()});f.each(c,function(a,b){var c=b.user_id+"@"+b.user_source,d=f.Deferred();y.then(function(a){var b=0;f.each(a.results,function(a,d){if(d.user_id+"@"+d.user_source===c)return b=d.is_online,!1});d.resolve(b);delete x[c]},
        function(a){d.reject(a);delete x[c]});x[c]=d.promise()})}(function(){var a=0;f(g).each(function(b,c){c.promise.then(function(b){d[c.key]=b;a++;a===g.length&&m()},function(b){a++;a===g.length&&m()})})})()};b.prototype.updateOnlineStatus=function(a,b){var c=this,d=b;a===t.FIRST&&(d=b.slice(0,50));setTimeout(function(){c.getUsersOnlineInfo(d)},2E3)};b.prototype.setLoginInfo=function(a,b,c){r.set({name:"loginInfo",value:{status:a,user:{user_id:u.get().user_id,user_source:u.get().user_source}}},b,c)};
        b.prototype.getLoginInfo=function(a,b){r.get("loginInfo",a,b)};b.prototype.setImToken=function(a,b,c){r.set({name:"imToken",value:a},b,c)};b.prototype.getImToken=function(a,b){r.get("imToken",a,b)};b.prototype.clearAll=function(a,b){r.clearAll(a,b)};b.prototype.getCometStatus=function(a,b){r.get("comet",a,b)};b.prototype.setCometStatus=function(a,b,c){var d=(new Date).getTime();r.set({name:"comet",value:{heartStamp:d,isForceOff:a}},b,c)};l.exports=b},function(l,b){b=function(){};b.prototype.convert=
        function(a){if(!a)return a;var b;-1<a.indexOf("https:")?b=a.substr(6):-1<a.indexOf("http:")?b=a.substr(5):0===a.indexOf("//")&&(b=a);return b};l.exports=new b},function(l,b,a){a(1);var f=a(98),h=a(5);b=function(){h.call(this)};b.prototype=Object.create(h.prototype);b.prototype.getCaptcha=function(a,b,h){f("get_captcha",a,null,b,h)};b.prototype.validateCaptcha=function(a,b,h){f("validate_captcha",a,null,b,h)};l.exports=new b},function(l,b,a){var f=a(1);a(98);var h=a(5),m=a(57),g=a(106).syn,r=a(125),
        u=a(84).get(),n=a(103),z=function(a,b,f){var c=this;if("message"==a.valueType)c._options.ack(a,function(){for(var d=[],e=0,f=a.value.length;e<f;e++)d.push(a.value[e]);0<d.length&&c.triggerEvent("msgReceived",a.value);void 0;b&&b()},function(){void 0;c.onDisconnect("ack fail.token expired.");f&&f()});else if("command"==a.valueType)switch(a.value[0].name){case "FORCEOFF":void 0;c.onDisconnect("FORCEOFF");var h={name:"comet",value:{heartStamp:(new Date).getTime(),isForceOff:!0}};g.set(h,function(){},
            function(){});break;case "SYNCUSERDATA":void 0;c.connect();break;case "TOKENEXPIRED":void 0;c.onDisconnect("TOKENEXPIRED");c.onLogout("TOKENEXPIRED");break;case "TOKENINVALID":void 0,c.onDisconnect("TOKENINVALID"),c.onLogout("TOKENINVALID")}else"commandmsg"==a.valueType&&c._options.ack(a,function(){for(var d=[],e=0,f=a.value.length;e<f;e++){var g=a.value[e],h;h="string"==typeof g.content?JSON.parse(g.content):g.content;if(-1!==["audio","video"].indexOf(h.data.call_type)){var l="call_"+h.data.call_type;
            d.push({msg_id:g.msg_id,msg_type:g.msg_type,send_time:g.send_time,sender_id:h.data.sender_id,sender_source:h.data.sender_source,show_type:l,to_id:g.to_id,to_source:g.to_source,content:{type:l}})}}0<d.length&&c.triggerEvent("msgReceived",d);void 0;b&&b()},function(){void 0;c.onDisconnect("ack fail.token expired.");f&&f()})};b=function(a){h.call(this);this._url=this._getHeartTimer=this._setHeartTimer=null;this._commonParams={};this._isconnected=!1;this._heartStamp=this._options=null;(function(b){var c=
        {ack:function(a){a()}};f.extend(c,a);b._options=c;b._getHeartTimer=new m({onElapsed:function(a){var c=(new Date).getTime();g.get("comet",function(d){!d||5E3<c-d.heartStamp&&!d.isForceOff?g.set({name:"comet",value:{heartStamp:c,isForceOff:!1}},function(){void 0;b.connect(function(){b._setHeartTimer.stop()});a()}):a()},function(){b._getHeartTimer.setDuration(0);a()})},duration:3E3});b._setHeartTimer=new m({onElapsed:function(a){var c=(new Date).getTime();b._heartStamp&&3E4<c-b._heartStamp?b._setHeartTimer.stop():
        g.set({name:"comet",value:{heartStamp:c,isForceOff:!1}},function(){b._heartStamp=c;a()},function(){b._setHeartTimer.setDuration(0);a()})},duration:1E3})})(this)};b.prototype=Object.create(h.prototype);b.prototype.init=function(a,b){this._url=a;this._commonParams=b};b.prototype.start=function(){this._getHeartTimer.start()};b.prototype.stop=function(){this._setHeartTimer&&this._setHeartTimer.stop();this._getHeartTimer&&this._getHeartTimer.stop()};b.prototype.connect=function(a){void 0;var b=this;b.triggerEvent("mainPageChanged");
        b.triggerEvent("connectchange",!0);b._isconnected=!0;b._setHeartTimer.start();b.cometConnect({comet_type:"jsonp",is_json:!0,is_new:!0},function(a){void 0;var c=function(){var c=0;return function(){c++;c===a.data.length&&b.connect()}}(),g=function(a){z.call(b,a,function(){c()},function(){})};f.each(a.data,function(a,b){g(b)})},function(c){a&&a();void 0;b.connect()})};b.prototype.cometConnect=function(a,b,g){a=f.extend(a,this._commonParams);var c=this._url,h=null;"wap"==u&&(h=12E4);n({url:c,method:"get",
        datatype:"jsonp",getparams:a,timeout:h},function(a){b(a)},function(a,b,c){g(c)})};b.prototype.onDisconnect=function(a){this._isconnected=!1;this._setHeartTimer.stop();void 0;this.triggerEvent("connectchange",!1,a)};b.prototype.onLogout=function(a){var b=this;g.set({name:"loginInfo",value:{status:!1,user:{user_id:r.get().user_id,user_source:r.get().user_source}}},function(){b.triggerEvent("logout",a);void 0},function(){})};l.exports=b},function(l,b,a){a(1);var f=a(95),h=a(83),m=function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,
        function(a){var b=16*Math.random()|0;return("x"==a?b:b&3|8).toString(16)})};l.exports=function(){var a,b=window.localStorage;b?b.getItem("im_uuid")?a=b.getItem("im_uuid"):(a=m(),b.setItem("im_uuid",a)):(b=h("webim-uuid"),b.load(),a=b.getAttribute("im_uuid"),a||(a=m(),b.setAttribute("im_uuid",a),b.save()));a+="########";var b=f.os.family.toLowerCase(),l="";0<=b.indexOf("windows")?l="Windows":0<=b.indexOf("ios")?l="IOS":0<=b.indexOf("android")?l="Android":0<=b.indexOf("linux")&&(l="Linux");return a+
        (l+"#"+f.os.version+"#")+"##"}()}]);